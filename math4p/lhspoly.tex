%% =======================================================
%% (c) Tobias Schoofs
%% =======================================================
%% Math 4 Programmers - The Inverse Element
%% =======================================================

% Plain Style
\documentclass[tikz]{scrreprt}

% Springer Style
%\documentclass[envcountsame]{llncs}

%% ODER: format ==         = "\mathrel{==}"
%% ODER: format /=         = "\neq "
%
%
\makeatletter
\@ifundefined{lhs2tex.lhs2tex.sty.read}%
  {\@namedef{lhs2tex.lhs2tex.sty.read}{}%
   \newcommand\SkipToFmtEnd{}%
   \newcommand\EndFmtInput{}%
   \long\def\SkipToFmtEnd#1\EndFmtInput{}%
  }\SkipToFmtEnd

\newcommand\ReadOnlyOnce[1]{\@ifundefined{#1}{\@namedef{#1}{}}\SkipToFmtEnd}
\usepackage{amstext}
\usepackage{amssymb}
\usepackage{stmaryrd}
\DeclareFontFamily{OT1}{cmtex}{}
\DeclareFontShape{OT1}{cmtex}{m}{n}
  {<5><6><7><8>cmtex8
   <9>cmtex9
   <10><10.95><12><14.4><17.28><20.74><24.88>cmtex10}{}
\DeclareFontShape{OT1}{cmtex}{m}{it}
  {<-> ssub * cmtt/m/it}{}
\newcommand{\texfamily}{\fontfamily{cmtex}\selectfont}
\DeclareFontShape{OT1}{cmtt}{bx}{n}
  {<5><6><7><8>cmtt8
   <9>cmbtt9
   <10><10.95><12><14.4><17.28><20.74><24.88>cmbtt10}{}
\DeclareFontShape{OT1}{cmtex}{bx}{n}
  {<-> ssub * cmtt/bx/n}{}
\newcommand{\tex}[1]{\text{\texfamily#1}}	% NEU

\newcommand{\Sp}{\hskip.33334em\relax}


\newcommand{\Conid}[1]{\mathit{#1}}
\newcommand{\Varid}[1]{\mathit{#1}}
\newcommand{\anonymous}{\kern0.06em \vbox{\hrule\@width.5em}}
\newcommand{\plus}{\mathbin{+\!\!\!+}}
\newcommand{\bind}{\mathbin{>\!\!\!>\mkern-6.7mu=}}
\newcommand{\rbind}{\mathbin{=\mkern-6.7mu<\!\!\!<}}% suggested by Neil Mitchell
\newcommand{\sequ}{\mathbin{>\!\!\!>}}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\usepackage{polytable}

%mathindent has to be defined
\@ifundefined{mathindent}%
  {\newdimen\mathindent\mathindent\leftmargini}%
  {}%

\def\resethooks{%
  \global\let\SaveRestoreHook\empty
  \global\let\ColumnHook\empty}
\newcommand*{\savecolumns}[1][default]%
  {\g@addto@macro\SaveRestoreHook{\savecolumns[#1]}}
\newcommand*{\restorecolumns}[1][default]%
  {\g@addto@macro\SaveRestoreHook{\restorecolumns[#1]}}
\newcommand*{\aligncolumn}[2]%
  {\g@addto@macro\ColumnHook{\column{#1}{#2}}}

\resethooks

\newcommand{\onelinecommentchars}{\quad-{}- }
\newcommand{\commentbeginchars}{\enskip\{-}
\newcommand{\commentendchars}{-\}\enskip}

\newcommand{\visiblecomments}{%
  \let\onelinecomment=\onelinecommentchars
  \let\commentbegin=\commentbeginchars
  \let\commentend=\commentendchars}

\newcommand{\invisiblecomments}{%
  \let\onelinecomment=\empty
  \let\commentbegin=\empty
  \let\commentend=\empty}

\visiblecomments

\newlength{\blanklineskip}
\setlength{\blanklineskip}{0.66084ex}

\newcommand{\hsindent}[1]{\quad}% default is fixed indentation
\let\hspre\empty
\let\hspost\empty
\newcommand{\NB}{\textbf{NB}}
\newcommand{\Todo}[1]{$\langle$\textbf{To do:}~#1$\rangle$}

\EndFmtInput
\makeatother
%

\include{cmds}

\begin{document}
\setlength{\parindent}{0pt}
\setlength{\parskip}{8pt}

\chapter{Polynomials} % c07
\section{Numeral Systems}
\ignore{
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[B]{}\mathbf{module}\;\Conid{NumSystem}{}\<[E]%
\\
\>[B]{}\mathbf{where}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{\Conid{System}.Random}\;(\Varid{randomRIO}){}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Natural}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Quoz}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Real}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
}

A numeral system consists of a finite set of digits, $D$,
and a base, $b$, for which $b=|D|$, \ie\ $b$ is the cardinality of $D$.
The binary system, for instance, 
uses the digits $D=\lbrace 0,1\rbrace$.
The cardinality of $D$ in this case, hence, is 2.
The decimal system uses the digits $D=\lbrace 0\dots 9\rbrace$ and,
thus, has the base $b=10$.
The hexadecimal system uses the digits $D=\lbrace 0\dots 15\rbrace$,
often given as $D=\lbrace 0\dots 9,a,b,c,d,e,f\rbrace$,
and, therefore, has the base $b=16$.

Numbers in any numeral system are usually represented as strings
of digits. The string

\[
10101010,
\]

for instance, may represent a number in the binary system.
(It could be a number in decimal format, too, though.)
The string 

\[
170,
\]

by contrast, cannot be a binary number, because
it contains the digit 7, which is not element of $D$
in the binary system.
It can represent a decimal (or a hexadecimal number).
The string

\[
aa,
\]

can represent a number in the hexadecimal system
(but not one of in the binary or decimal system).

We interpret such a string, \ie\ convert it
to the decimal system, by rewriting it 
as a formula of the form:

\[
a_nb^n + a_{n-1}b^{n-1} + \dots + a_0b^0,
\]

where $a_i$ are the digits that appear in the string,
$b$ is the base and $n$ is position of the left-most digit
starting to count with 0 on the right-hand side of the string.
The string $10101010$ in binary notation,hence, is interpreted as

\[
1\times 2^7 + 0\times 2^6 + 1\times 2^5 + 0\times 2^4 + 
1\times 2^3 + 0\times 2^2 + 1\times 2^1 + 0\times 2^0,
\]

which can be simplified to

\[
2^7 + 2^5 + 2^3 + 2,
\]

which, in its turn, is

\[
128 + 32 + 8 + 2 = 170.
\]

The string 170 in decimal notation is interpreted as

\[
10^2 + 7\times 10 = 170.
\]

Interpreting a string in the notation it is written in
yields just that string.
The string $aa$ in hexadecimal notation is interpreted as

\[
a\times 16 + a.
\]

The digit $a$, however, is just 10. We, hence, get the equation

\[
10\times 16 + 10 = 160 + 10 = 170.
\]

What do we get, when we relax some of the constraints
defining a numeral system?
Instead of using a finite set of digits,
we could use a number field, $F$, (finite or infinite)
so that any member of that field qualifies as coefficient
in the formulas we used above to interpret numbers
in the decimal system. We would then relax the rule
that the base must be the cardinality of the field.
Instead, we allow any member $x$ of the field 
to serve as a base.
Formulas we get from those new rules would follow the recipe:

\[
a_nx^n + a_{n-1}x^{n-1} + \dots + a_0x^0
\]

or shorter:

\[
\sum_{i=0}^n{a_ix^i}
\]

with $a_i, x \in F$.

Such beasts are indeed well-known. They are very prominent, in fact,
and their name is \term{polynomial}.

The name \emph{poly}nomial stems from the fact
that polynomials may be composed of many terms;
a monomial, by contrast, is a polynomial 
that consists of only one term.
For instance,

\[
5x^2
\]

is a monomial. A binomial is a polynomial
that consists of two terms. This is
an example of a binomial:

\[
x^5 + 2x.
\]

There is nothing special about
monomials and binomials, at least nothing
that would affect their definition as polynomials.
Monomials and binomials are just
polynomials that happen to have only
one or, respectively, two terms.

Polynomials share many properties with numbers.
Like numbers, arithmetic, including
addition, subtraction, multiplication and division
as well as exponentiation, can be defined over polynomials. 
In some cases, numbers reveal their close relation
to polynomials. The binomial theorem states,
for instance, that a product of the form 

\[
(a+b)(a+b)
\]

translates to a formula involving binomial coefficients:

\[
a^2 + 2ab + b^2.
\]

We can interpret this formula as the product 
of the polynomial $x+a$:

\[
(x+a)(x+a),
\]

which yields just another polynomial:

\[
x^2 + 2ax + a^2
\]

Let us replace $a$ for the number 3
and fix $x=10$. We get:

\begin{equation}
(10+3)(10+3) = 10^2 + 2\times 3\times 10 + 3^2 = 100 + 60 + 9 = 169,
\end{equation}

which is just the result of the multiplication $13\times 13$.
Usually, it is harder to recognise this kind of relations 
numbers have with the binomial theorem (and, hence, with polynomials),
because most binomial coefficients are too big to be represented
by a single-digit number. Already in the product $14\times 14$,
the binomial coefficients are hidden. Let us look at this multiplication
treated as the polynomial $(x+a)$ with $x=10$ and $a=4$:

\[
(10 + 4) (10 + 4) = 
10^2 + 2\times 4\times 10 + 4^2 =
100 + 2\times 40 + 16.
\]

When we look at the resulting number, we do not recognise
the binomial coefficient anymore -- they are \emph{carried} away:
$100 + 2\times 40 + 16 = 100 + 80 + 16 = 196$.

Indeed, polynomials are not numbers.
Those are different concepts.
Another important difference is that polynomials do not establish
a clear order. For any two distinct numbers, we can clearly say
which of the two is the greater and which is the smaller one.
We cannot decide that based on the formula of the polynomial alone.
One way to decide quickly which of two numbers is the grater one
is to look at the number of their digits. The one with more digits
is necessarily the greater one. In any numeral system it holds that:

\[
a_3b^3 + a_2b^2 + a_1b + a_0 > c_2b^2 + c_1b + c_0
\]

independent of the values of the $a$s and the $c$s.
For polynomials, this is not true. Consider the following example:

\[
x^3 + x^2 + x + 1 > 100x^2?
\]

For $x=10$, the left-hand side of the inequation is
$1000 + 100 + 10 + 1 = 1111$;
the right-hand side, however, is $100\times 100 = 10000$.

In spite of such differences, we can represent polynomials
very similar to how we represented numbers,
namely as a list of coefficients. This is a valid
implementation in Haskell:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\mathbf{type}\;\Conid{Poly}\;\Varid{a}\mathrel{=}\Conid{P}\;[\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{deriving}\;(\Conid{Show}){}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

We add a safe constructor:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{23}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{poly}\mathbin{::}(\Conid{Eq}\;\Varid{a},\Conid{Num}\;\Varid{a})\Rightarrow [\mskip1.5mu \Varid{a}\mskip1.5mu]\to \Conid{Poly}\;\Varid{a}{}\<[E]%
\\
\>[3]{}\Varid{poly}\;[\mskip1.5mu \mskip1.5mu]\mathrel{=}\Varid{error}\;\text{\tt \char34 not~a~polynomial\char34}{}\<[E]%
\\
\>[3]{}\Varid{poly}\;\Varid{as}\mathrel{=}\Conid{P}\;(\Varid{cleanz}\;\Varid{as}){}\<[E]%
\\[\blanklineskip]%
\>[3]{}\Varid{cleanz}\mathbin{::}(\Conid{Eq}\;\Varid{a},\Conid{Num}\;\Varid{a})\Rightarrow [\mskip1.5mu \Varid{a}\mskip1.5mu]\to [\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{cleanz}\;\Varid{xs}\mathrel{=}\Varid{reverse}\mathbin{\$}\Varid{go}\;(\Varid{reverse}\;\Varid{xs}){}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{go}\;[\mskip1.5mu \mskip1.5mu]{}\<[23]%
\>[23]{}\mathrel{=}[\mskip1.5mu \mskip1.5mu]{}\<[E]%
\\
\>[12]{}\Varid{go}\;[\mskip1.5mu \mathrm{0}\mskip1.5mu]{}\<[23]%
\>[23]{}\mathrel{=}[\mskip1.5mu \mathrm{0}\mskip1.5mu]{}\<[E]%
\\
\>[12]{}\Varid{go}\;(\mathrm{0}\mathbin{:}\Varid{xs}){}\<[23]%
\>[23]{}\mathrel{=}\Varid{go}\;\Varid{xs}{}\<[E]%
\\
\>[12]{}\Varid{go}\;\Varid{xs}{}\<[23]%
\>[23]{}\mathrel{=}\Varid{xs}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

The constructor makes sure that the resulting polynomial
has at least one coefficient and that all the coefficients
are actually numbers and comparable for equality.
The function \ensuremath{\Varid{cleanz}} called in the constructor
removes leading zeros (which are redundant), just as we did 
when we defined natural numbers.
But note that we reverse, first, the list of coefficients
passed to \ensuremath{\Varid{go}} and, second, the result of \ensuremath{\Varid{go}}.
This means that we store the coefficients from left to right
in ascending order. Usually, we write polynomials out
in descending order of their weight, \ie\:

\[
x^n + x^{n-1} + \dots + x^0.
\]

But, here, we store them in the order:

\[
x^0 + x^1 + \dots + x^{n-1} + x^n.
\]

The following function gets the list of coefficients back:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{coeffs}\mathbin{::}\Conid{Poly}\;\Varid{a}\to [\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{coeffs}\;(\Conid{P}\;\Varid{as})\mathrel{=}\Varid{as}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

Here is a function to pretty-print polynomials:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{16}{@{}>{\hspre}l<{\hspost}@{}}%
\column{30}{@{}>{\hspre}l<{\hspost}@{}}%
\column{35}{@{}>{\hspre}l<{\hspost}@{}}%
\column{38}{@{}>{\hspre}c<{\hspost}@{}}%
\column{38E}{@{}l@{}}%
\column{41}{@{}>{\hspre}l<{\hspost}@{}}%
\column{52}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{pretty}\mathbin{::}(\Conid{Num}\;\Varid{a},\Conid{Show}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow \Conid{Poly}\;\Varid{a}\to \Conid{String}{}\<[E]%
\\
\>[3]{}\Varid{pretty}\;\Varid{p}\mathrel{=}\Varid{go}\;(\Varid{reverse}\mathbin{\$}\Varid{weigh}\;\Varid{p}){}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{go}\;{}\<[16]%
\>[16]{}[\mskip1.5mu \mskip1.5mu]\mathrel{=}\text{\tt \char34 \char34}{}\<[E]%
\\
\>[12]{}\Varid{go}\;{}\<[16]%
\>[16]{}((\Varid{i},\Varid{c})\mathbin{:}\Varid{cs})\mathrel{=}{}\<[30]%
\>[30]{}\mathbf{let}\;{}\<[35]%
\>[35]{}\Varid{x}{}\<[38]%
\>[38]{}\mid {}\<[38E]%
\>[41]{}\Varid{i}\equiv \mathrm{0}{}\<[52]%
\>[52]{}\mathrel{=}\text{\tt \char34 \char34}{}\<[E]%
\\
\>[38]{}\mid {}\<[38E]%
\>[41]{}\Varid{i}\equiv \mathrm{1}{}\<[52]%
\>[52]{}\mathrel{=}\text{\tt \char34 x\char34}{}\<[E]%
\\
\>[38]{}\mid {}\<[38E]%
\>[41]{}\Varid{otherwise}{}\<[52]%
\>[52]{}\mathrel{=}\text{\tt \char34 x\char94 \char34}\plus \Varid{show}\;\Varid{i}{}\<[E]%
\\
\>[35]{}\Varid{t}{}\<[38]%
\>[38]{}\mid {}\<[38E]%
\>[41]{}\Varid{c}\equiv \mathrm{1}{}\<[52]%
\>[52]{}\mathrel{=}\Varid{x}{}\<[E]%
\\
\>[38]{}\mid {}\<[38E]%
\>[41]{}\Varid{otherwise}{}\<[52]%
\>[52]{}\mathrel{=}\Varid{show}\;\Varid{c}\plus \Varid{x}{}\<[E]%
\\
\>[35]{}\Varid{o}{}\<[38]%
\>[38]{}\mid {}\<[38E]%
\>[41]{}\Varid{null}\;\Varid{cs}{}\<[52]%
\>[52]{}\mathrel{=}\text{\tt \char34 \char34}{}\<[E]%
\\
\>[38]{}\mid {}\<[38E]%
\>[41]{}\Varid{otherwise}{}\<[52]%
\>[52]{}\mathrel{=}\text{\tt \char34 ~+~\char34}{}\<[E]%
\\
\>[30]{}\mathbf{in}\;\mathbf{if}\;\Varid{c}\equiv \mathrm{0}\;\mathbf{then}\;\Varid{go}\;\Varid{cs}\;\mathbf{else}\;\Varid{t}\plus \Varid{o}\plus \Varid{go}\;\Varid{cs}{}\<[E]%
\\[\blanklineskip]%
\>[3]{}\Varid{weigh}\mathbin{::}(\Conid{Num}\;\Varid{a})\Rightarrow \Conid{Poly}\;\Varid{a}\to [\mskip1.5mu (\Conid{Integer},\Varid{a})\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{weigh}\;(\Conid{P}\;[\mskip1.5mu \mskip1.5mu])\mathrel{=}[\mskip1.5mu \mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{weigh}\;(\Conid{P}\;\Varid{as})\mathrel{=}(\Varid{zip}\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mskip1.5mu]\;\Varid{as}){}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

The function demonstrates how we actually 
interpret the list of coefficients.
We first \ensuremath{\Varid{weigh}} them by zipping the list of coefficients 
with a list of integers starting at 0.
One could say: we count the coefficients.
Note that we start with 0, so that
the first coefficient gets the weight 0, 
the second gets the weight 1 and so on.
That, again, reflects our descending
ordering of coefficients.

The reversed weighted list is then passed to \ensuremath{\Varid{go}},
which does the actual printing.
We first determine the substring describing $x$:
if $i$, the weight, is 0, we do not want to write the $x$,
since $x^0=1$. If $i=1$, we just write $x$.
Otherwise we write $x^i$.

Then we determine the term composed of coefficient and $x$.
If the coefficient, $c$ is 1, we just write $x$;
otherwise, we concatenate $c$ with $x$.
Note, however, that we later consider an additional case,
namely, when $c=0$. In this case, we ignore the whole term.

We still consider the operation. 
If the remainder of the list is \ensuremath{\Varid{null}}, \ie\ 
we are now handling the last term, \ensuremath{\Varid{o}} is the empty string.
Otherwise, it is the plus symbol.
Here is room for improvement:
when the coefficient is negative, we do not really need
the operation, since we then write $+ -cx$.
Nicer would be to write only $-cx$.

Finally, we put everything together concatenating a string
composed of term, operation and \ensuremath{\Varid{go}} applied on the remainder 
of the list. 

Here is a list of polynomials and how they are
represented with our Haksell type:

\begin{center}
\begingroup
\renewcommand{\arraystretch}{1.5}
\begin{tabular}{|c||c|}
\hline
$x^2 + x + 1$ & \ensuremath{\Varid{poly}\;[\mskip1.5mu \mathrm{1},\mathrm{1},\mathrm{1}\mskip1.5mu]}\\\hline
$5x^5 + 4x^4 + 3x^3 + 2x^2 + x$ &
\ensuremath{\Varid{poly}\;[\mskip1.5mu \mathrm{0},\mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4},\mathrm{5}\mskip1.5mu]}\\\hline
$5x^4 + 4x^3 + 3x^2 + 2x + 1$  &
\ensuremath{\Varid{poly}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4},\mathrm{5}\mskip1.5mu]}\\\hline
$5x^4 + 3x^2 + 1$  &
\ensuremath{\Varid{poly}\;[\mskip1.5mu \mathrm{1},\mathrm{0},\mathrm{3},\mathrm{0},\mathrm{5}\mskip1.5mu]}\\\hline
\end{tabular}
\endgroup
\end{center}

An important concept related to polynomials is the 
\term{degree}. The degree is a measurement of the
\emph{size} of the polynomial. In concrete terms,
it is the greatest exponent in the polynomial.
For us, it is the weight of the right-most element
in the polynomial or, much simpler, the length
of the list of coefficients minus one -- since,
we start with zero!
The following function computes the degree
of a given polynomial:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{degree}\mathbin{::}\Conid{Poly}\;\Varid{a}\to \Conid{Int}{}\<[E]%
\\
\>[3]{}\Varid{degree}\;(\Conid{P}\;\Varid{as})\mathrel{=}\Varid{length}\;\Varid{as}\mathbin{-}\mathrm{1}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

Note, by the way, that polynomials of degree 0,
those with only one trivial term, 
are just constant numbers.

Finally, here is a useful function that 
creates random polynomials with \ensuremath{\Conid{Natural}}
coefficients:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{22}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{randomPoly}\mathbin{::}\Conid{Natural}\to \Conid{Int}\to \Conid{IO}\;(\Conid{Poly}\;\Conid{Natural}){}\<[E]%
\\
\>[3]{}\Varid{randomPoly}\;\Varid{n}\;\Varid{d}\mathrel{=}\mathbf{do}{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\Varid{cs}\leftarrow \Varid{cleanz}\mathbin{<\$>}\Varid{mapM}\;(\mathbin{\char92 \char95 }\to \Varid{randomCoeff}\;\Varid{n})\;[\mskip1.5mu \mathrm{1}\mathinner{\ldotp\ldotp}\Varid{d}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{if}\;\Varid{length}\;\Varid{cs}\mathbin{<}\Varid{d}\;\mathbf{then}\;\Varid{randomPoly}\;\Varid{n}\;\Varid{d}{}\<[E]%
\\
\>[5]{}\hsindent{17}{}\<[22]%
\>[22]{}\mathbf{else}\;\Varid{return}\;(\Conid{P}\;\Varid{cs}){}\<[E]%
\\[\blanklineskip]%
\>[3]{}\Varid{randomCoeff}\mathbin{::}\Conid{Natural}\to \Conid{IO}\;\Conid{Natural}{}\<[E]%
\\
\>[3]{}\Varid{randomCoeff}\;\Varid{n}\mathrel{=}\Varid{randomNatural}\;(\mathrm{0},\Varid{n}\mathbin{-}\mathrm{1}){}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

The function receives a \ensuremath{\Conid{Natural}} and an \ensuremath{\Conid{Int}}.
The \ensuremath{\Conid{Int}} indicates the degree of the polynomial
we want to obtain. The \ensuremath{\Conid{Natural}} is used to
restrict the size of the coefficients we want
to see in the polynomial.
In \ensuremath{\Varid{randomCoeff}}, we use the \ensuremath{\Varid{randomNatural}}
defined in the previous chapter to generate 
a random number between 0 and $n-1$. You might
suspect already where that will lead us:
to polynomials modulo some number.
But before we get there, 
we will study polynomial arithmetic.
\section{Polynomial Arithmetic}
\ignore{
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[B]{}\mathbf{module}\;\Conid{PolyArith}{}\<[E]%
\\
\>[B]{}\mathbf{where}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Natural}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Quoz}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Real}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{NumSystem}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Modular}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
}

We start with addition and subtraction,
which, in German, are summarised by
the beautiful word \term{strichrechnung}
meaning literally ``dash calculation'' as
opposed to \term{punkt\-rech\-nung} or ``dot calculation'',
which would be multiplication and division.

Polynomial \term{strichrechnung} is easy.
Key is to realise that the structure of polynomials 
is already defined by \term{strichrechnung}:
it is composed of terms each of which is a product
of some number and a power of $x$.
When we add (or subtract) two polynomials, we just sort them
according to the exponents of their terms
and add (or subtract) terms with equal exponents:

\begin{equation}
\begin{array}{crcrcccr}
  & ax^n     & + & bx^{n-1}     & + & \dots & + & c\\
+ & dx^n     & + & ex^{n-1}     & + & \dots & + & f\\
= & (a+d)x^n & + & (b+e)x^{n-1} & + & \dots & + & c+f
\end{array}
\end{equation}

With our polynomial representation, it is easy 
to implement this kind of operation. One might think
it was designed especially to support addition and
subtraction. Here is a valid implementation:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{25}{@{}>{\hspre}l<{\hspost}@{}}%
\column{30}{@{}>{\hspre}c<{\hspost}@{}}%
\column{30E}{@{}l@{}}%
\column{33}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{add}\mathbin{::}(\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}{}\<[E]%
\\
\>[3]{}\Varid{add}\mathrel{=}\Varid{strich}\;(\mathbin{+}){}\<[E]%
\\[\blanklineskip]%
\>[3]{}\Varid{sub}\mathbin{::}(\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}{}\<[E]%
\\
\>[3]{}\Varid{sub}\mathrel{=}\Varid{strich}\;(\mathbin{-}){}\<[E]%
\\[\blanklineskip]%
\>[3]{}\Varid{strich}\mathbin{::}(\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow (\Varid{a}\to \Varid{a}\to \Varid{a})\to \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}{}\<[E]%
\\
\>[3]{}\Varid{strich}\;\Varid{o}\;(\Conid{P}\;\Varid{x})\;(\Conid{P}\;\Varid{y}){}\<[25]%
\>[25]{}\mathrel{=}\Conid{P}\;(\Varid{strichlist}\;\Varid{o}\;\Varid{x}\;\Varid{y}){}\<[E]%
\\[\blanklineskip]%
\>[3]{}\Varid{strichlist}\mathbin{::}(\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow (\Varid{a}\to \Varid{a}\to \Varid{a})\to [\mskip1.5mu \Varid{a}\mskip1.5mu]\to [\mskip1.5mu \Varid{a}\mskip1.5mu]\to [\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{strichlist}\;\Varid{o}\;\Varid{xs}\;\Varid{ys}\mathrel{=}\Varid{cleanz}\;(\Varid{go}\;\Varid{xs}\;\Varid{ys}){}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{go}\;[\mskip1.5mu \mskip1.5mu]\;\Varid{bs}{}\<[30]%
\>[30]{}\mathrel{=}{}\<[30E]%
\>[33]{}\Varid{bs}{}\<[E]%
\\
\>[12]{}\Varid{go}\;\Varid{as}\;[\mskip1.5mu \mskip1.5mu]{}\<[30]%
\>[30]{}\mathrel{=}{}\<[30E]%
\>[33]{}\Varid{as}{}\<[E]%
\\
\>[12]{}\Varid{go}\;(\Varid{a}\mathbin{:}\Varid{as})\;(\Varid{b}\mathbin{:}\Varid{bs}){}\<[30]%
\>[30]{}\mathrel{=}{}\<[30E]%
\>[33]{}\Varid{a}\mathbin{`\Varid{o}`}\Varid{b}\mathbin{:}\Varid{go}\;\Varid{as}\;\Varid{bs}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

Here is one more function that might be useful 
later on; it folds \ensuremath{\Varid{strichlist}} on a list of lists of coefficients:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{strichf}\mathbin{::}(\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow (\Varid{a}\to \Varid{a}\to \Varid{a})\to [\mskip1.5mu [\mskip1.5mu \Varid{a}\mskip1.5mu]\mskip1.5mu]\to [\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{strichf}\;\Varid{o}\mathrel{=}\Varid{foldl'}\;(\Varid{strichlist}\;\Varid{o})\;[\mskip1.5mu \mskip1.5mu]{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

\term{Punktrechnung}, \ie\ multiplication and division,
are a bit more complex -- because of the distribution law.
Let us start with the simple case where we distribute
a monomial over a polynomial:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{25}{@{}>{\hspre}c<{\hspost}@{}}%
\column{25E}{@{}l@{}}%
\column{28}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{mul1}\mathbin{::}\Conid{Num}\;\Varid{a}\Rightarrow (\Varid{a}\to \Varid{a}\to \Varid{a})\to \Conid{Int}\to [\mskip1.5mu \Varid{a}\mskip1.5mu]\to \Varid{a}\to [\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{mul1}\;\Varid{o}\;\Varid{i}\;\Varid{as}\;\Varid{a}\mathrel{=}\Varid{zeros}\;\Varid{i}\plus \Varid{go}\;\Varid{as}\;\Varid{a}{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{go}\;[\mskip1.5mu \mskip1.5mu]\;\anonymous {}\<[25]%
\>[25]{}\mathrel{=}{}\<[25E]%
\>[28]{}[\mskip1.5mu \mskip1.5mu]{}\<[E]%
\\
\>[12]{}\Varid{go}\;(\Varid{c}\mathbin{:}\Varid{cs})\;\Varid{x}{}\<[25]%
\>[25]{}\mathrel{=}{}\<[25E]%
\>[28]{}\Varid{c}\mathbin{`\Varid{o}`}\Varid{x}\mathbin{:}\Varid{go}\;\Varid{cs}\;\Varid{x}{}\<[E]%
\\[\blanklineskip]%
\>[3]{}\Varid{zeros}\mathbin{::}\Conid{Num}\;\Varid{a}\Rightarrow \Conid{Int}\to [\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{zeros}\;\Varid{i}\mathrel{=}\Varid{take}\;\Varid{i}\mathbin{\$}\Varid{repeat}\;\mathrm{0}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

The function \ensuremath{\Varid{mul1}} takes a single term (the monomial)
and distributes it over the coefficients of a polynomial 
using the operation \ensuremath{\Varid{o}}.
Each term in the polynomial 
is combined with the single term.
This corresponds to the operation:

\begin{equation}
\begin{array}{rcrcrcccr}
dx^m & \times & ax^n      & + & bx^{n-1}    & + & \dots & + & c\\
     & =      & adx^{m+n} & + & bdx^{n-1+m} & + & \dots & + & cdx^m
\end{array}
\end{equation}

The function \ensuremath{\Varid{mul1}} receives on more parameter,
namely the \ensuremath{\Conid{Int}} $i$ and uses it to generate a sequence of zeros
that is put in front of the resulting coefficient list.
As we will see shortly, the list of zeros reflects the weight
of the single term. In fact, we do not implement the manipulation
of the exponents we see in the abstract formula directly.
Instead, the addition $+m$ is implicitly handled by placing
$m$ zeros at the head of the list resulting in a new polynomial
of degree $m+d$ where $d$ is the degree of the original polynomial.
A simple example:

\[
5x^2 \times (4x^3 + 3x^2 + 2x + 1) = 20x^5 + 15x^4 + 10x^3 + 5x^2
\]

would be:

\ensuremath{\Varid{mul1}\;\mathrm{2}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu]\;\mathrm{5}}

which is: 

\ensuremath{\Varid{zero}\;\mathrm{2}\plus (\mathrm{5}\mathbin{*}[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu])} $=$ \ensuremath{[\mskip1.5mu \mathrm{0},\mathrm{0},\mathrm{5},\mathrm{10},\mathrm{15},\mathrm{20}\mskip1.5mu]}

We, hence, would add 2 zeros, since 2 is the degree
of the monomial.

Now, when we multiply two polynomials, we need to map
all terms in one of the polynomials on the other polynomial
using \ensuremath{\Varid{mul1}}. We further need to pass the weight of
the individual terms of the first polynomial as the \ensuremath{\Conid{Int}}
parameter of \ensuremath{\Varid{mul1}}. What we want to do is:

\ensuremath{[\mskip1.5mu \Varid{mul1}\;(\mathbin{*})\;\Varid{i}\;(\Varid{coeffs}\;\Varid{p1})\;\Varid{p}\mid (\Varid{i},\Varid{p})\leftarrow \Varid{zip}\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mskip1.5mu]\;(\Varid{coeffs}\;\Varid{p2})\mskip1.5mu]}.

What would we get applying this formula on
the polynomials, say, 
\ensuremath{[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu]} and \ensuremath{[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu]}?
Let us have a look:

\ensuremath{[\mskip1.5mu \Varid{mul1}\;(\mathbin{*})\;\Varid{i}\;([\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu])\;\Varid{p}\mid (\Varid{i},\Varid{p})\leftarrow \Varid{zip}\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mskip1.5mu]\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu]\mskip1.5mu]}\\
\ensuremath{[\mskip1.5mu [\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu],[\mskip1.5mu \mathrm{0},\mathrm{10},\mathrm{12},\mathrm{14},\mathrm{16}\mskip1.5mu],[\mskip1.5mu \mathrm{0},\mathrm{0},\mathrm{15},\mathrm{18},\mathrm{21},\mathrm{24}\mskip1.5mu],[\mskip1.5mu \mathrm{0},\mathrm{0},\mathrm{0},\mathrm{20},\mathrm{24},\mathrm{28},\mathrm{32}\mskip1.5mu]\mskip1.5mu]}.

We see a list of four lists, 
one for each coefficient of \ensuremath{[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu]}.
The first list is the result of distributing 1 
over all the coefficients in \ensuremath{[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu]}.
Since 1 is the first element,
its weight is 0: no zeros are put before the resulting list.
The second list results from distributing 2 over \ensuremath{[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu]}.
Since 2 is the second element, its weight is 1:
we add one zero.
The same process is repeated for 3 and 4 resulting
in the third and fourth result list.
Since 3 is the the third element, the third resulting list
gets two zeros and, since 4 is the fourth element,
the fourth list gets three zeros.

How do we transform this list of lists back
into a single list of coefficients? Very easy:
we add them together using \ensuremath{\Varid{strichf}}:

\ensuremath{\Varid{strichf}\;(\mathbin{+})}
\ensuremath{[\mskip1.5mu [\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu],[\mskip1.5mu \mathrm{0},\mathrm{10},\mathrm{12},\mathrm{14},\mathrm{16}\mskip1.5mu],[\mskip1.5mu \mathrm{0},\mathrm{0},\mathrm{15},\mathrm{18},\mathrm{21},\mathrm{24}\mskip1.5mu],[\mskip1.5mu \mathrm{0},\mathrm{0},\mathrm{0},\mathrm{20},\mathrm{24},\mathrm{28},\mathrm{32}\mskip1.5mu]\mskip1.5mu]}

which is

\ensuremath{[\mskip1.5mu \mathrm{5},\mathrm{16},\mathrm{34},\mathrm{60},\mathrm{61},\mathrm{52},\mathrm{32}\mskip1.5mu]}.

This means that

\begin{equation}
(4x^3 + 3x^2 + 2x + 1) \times (8x^3 + 7x^2 + 6x + 5) =
32x^6 + 52x^5 + 61x^4 + 60x^3 + 34x^2 + 16x + 5.
\end{equation}

Here is the whole algorithm:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{14}{@{}>{\hspre}c<{\hspost}@{}}%
\column{14E}{@{}l@{}}%
\column{16}{@{}>{\hspre}c<{\hspost}@{}}%
\column{16E}{@{}l@{}}%
\column{17}{@{}>{\hspre}l<{\hspost}@{}}%
\column{19}{@{}>{\hspre}l<{\hspost}@{}}%
\column{28}{@{}>{\hspre}c<{\hspost}@{}}%
\column{28E}{@{}l@{}}%
\column{31}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{mul}\mathbin{::}(\Conid{Show}\;\Varid{a},\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}{}\<[E]%
\\
\>[3]{}\Varid{mul}\;\Varid{p1}\;\Varid{p2}{}\<[14]%
\>[14]{}\mid {}\<[14E]%
\>[17]{}\Varid{d2}\mathbin{>}\Varid{d1}{}\<[28]%
\>[28]{}\mathrel{=}{}\<[28E]%
\>[31]{}\Varid{mul}\;\Varid{p2}\;\Varid{p1}{}\<[E]%
\\
\>[14]{}\mid {}\<[14E]%
\>[17]{}\Varid{otherwise}{}\<[28]%
\>[28]{}\mathrel{=}{}\<[28E]%
\>[31]{}\Conid{P}\;(\Varid{strichf}\;(\mathbin{+})\;\Varid{ms}){}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{d1}{}\<[16]%
\>[16]{}\mathrel{=}{}\<[16E]%
\>[19]{}\Varid{degree}\;\Varid{p1}{}\<[E]%
\\
\>[12]{}\Varid{d2}{}\<[16]%
\>[16]{}\mathrel{=}{}\<[16E]%
\>[19]{}\Varid{degree}\;\Varid{p2}{}\<[E]%
\\
\>[12]{}\Varid{ms}{}\<[16]%
\>[16]{}\mathrel{=}{}\<[16E]%
\>[19]{}[\mskip1.5mu \Varid{mul1}\;(\mathbin{*})\;\Varid{i}\;(\Varid{coeffs}\;\Varid{p1})\;\Varid{p}\mathrel{\vee}(\Varid{i},\Varid{p})\leftarrow \Varid{zip}\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mskip1.5mu]\;(\Varid{coeffs}\;\Varid{p2})\mskip1.5mu]{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

On top of multiplication, we can implement power.
We will, of course, not implement a na\"ive approach
based on repeated multiplication alone. Instead,
we will use the \term{square-and-multiply} approach
we have already used before for numbers.
Here is the code:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{23}{@{}>{\hspre}c<{\hspost}@{}}%
\column{23E}{@{}l@{}}%
\column{26}{@{}>{\hspre}l<{\hspost}@{}}%
\column{37}{@{}>{\hspre}l<{\hspost}@{}}%
\column{59}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{powp}\mathbin{::}(\Conid{Show}\;\Varid{a},\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow \Conid{Natural}\to \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}{}\<[E]%
\\
\>[3]{}\Varid{powp}\;\Varid{f}\;\Varid{poly}\mathrel{=}\Varid{go}\;\Varid{f}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1}\mskip1.5mu])\;\Varid{poly}{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{go}\;\mathrm{0}\;\Varid{y}\;\anonymous {}\<[23]%
\>[23]{}\mathrel{=}{}\<[23E]%
\>[26]{}\Varid{y}{}\<[E]%
\\
\>[12]{}\Varid{go}\;\mathrm{1}\;\Varid{y}\;\Varid{x}{}\<[23]%
\>[23]{}\mathrel{=}{}\<[23E]%
\>[26]{}\Varid{mul}\;\Varid{y}\;\Varid{x}{}\<[E]%
\\
\>[12]{}\Varid{go}\;\Varid{n}\;\Varid{y}\;\Varid{x}{}\<[23]%
\>[23]{}\mid {}\<[23E]%
\>[26]{}\Varid{even}\;\Varid{n}{}\<[37]%
\>[37]{}\mathrel{=}\Varid{go}\;(\Varid{n}\mathbin{\Varid{`div`}}\mathrm{2})\;\Varid{y}\;{}\<[59]%
\>[59]{}(\Varid{mul}\;\Varid{x}\;\Varid{x}){}\<[E]%
\\
\>[23]{}\mid {}\<[23E]%
\>[26]{}\Varid{otherwise}{}\<[37]%
\>[37]{}\mathrel{=}\Varid{go}\;((\Varid{n}\mathbin{-}\mathrm{1})\mathbin{\Varid{`div`}}\mathrm{2})\;{}\<[59]%
\>[59]{}(\Varid{mul}\;\Varid{y}\;\Varid{x})\;{}\<[E]%
\\
\>[59]{}(\Varid{mul}\;\Varid{x}\;\Varid{x}){}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

The function \ensuremath{\Varid{powp}} receives a natural number,
that is the exponent, and a polynomial.
We kick off by calling \ensuremath{\Varid{go}} with the exponent, $f$,
a base polynomial \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1}\mskip1.5mu]}, \ie\ unity, and the polynomial
we want to raise to the power of \ensuremath{\Varid{f}}.
If $f=0$, we are done and return the base polynomial.
This reflects the case $x^0=1$.
If $f=1$, we multiply the base polynomial by the input polynomial.
Otherwise, if the exponent is even,
we halve it, pass the base polynomial on and square the input.
Otherwise, we pass the product of the base polynomial and the input
on instead of the base polynomial as it is.
This implementation differs a bit from the implementation
we presented before for numbers, but it implements the same
algorithm.

Here is a simple example: we raise the polynomial
$x + 1$ to the power of 5. In the first round, we compute

\ensuremath{\Varid{go}\;\mathrm{5}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])},

which, since 5 is odd, results in 

\ensuremath{\Varid{go}\;\mathrm{2}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu])}.

This, in its turn, results in

\ensuremath{\Varid{go}\;\mathrm{1}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{6},\mathrm{4},\mathrm{1}\mskip1.5mu])}.

This is the final step and results in 

\ensuremath{\Varid{mul}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{6},\mathrm{4},\mathrm{1}\mskip1.5mu])}, 

which is

\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{5},\mathrm{10},\mathrm{10},\mathrm{5},\mathrm{1}\mskip1.5mu]},

the polynomial $x^5 + 5x^4 + 10x^3 + 10x^2 + 5x + 1$.
You might have noticed that our Haskell notation
shows the binomial coefficients $\binom{n}{k}$ for
$n=0$, $n=1$, $n=2$, $n=4$ and $n=5$.
We never see $n=3$, which would be 
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{3},\mathrm{3},\mathrm{1}\mskip1.5mu]}, because we leave the multiplication
\ensuremath{\Varid{mul}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu])} out.
For this specific case with exponent 5,
leaving out this step is where square-and-multiply
is more efficient than multiplying five times.
With growing exponents, the saving quickly grows
to a significant order.

Division is, as usual, a bit more complicated than multiplication.
But it is not too different from number division. First,
we define polynomial division as Euclidean division, that is
we search the solution for the equation

\begin{equation}
\frac{a}{b} = q + r
\end{equation}

where $r < b$ and $bq+r=a$.

The manual process is as follows:
we divide the first term of $a$ by the first term of $b$.
The quotient goes to the result; then we multiply it by $b$
and set $a$ to $a$ minus that result.
Now we repeat the process
until the degree of $a$
is less than that of $b$.

Here is an example:

\[
\frac{4x^5 - x^4 + 2x^3 + x^2 - 1}{x^2 + 1}.
\]

We start by dividing $4x^5$ by $x^2$.
The quotient is $4x^3$, which we add to the result.
We multiply: $4x^3 \times (x^2 + 1) = 4x^5 + 4x^3$
and subtract the result from $a$:

\begin{equation}
\begin{array}{crcrcrcrcr}
  & 4x^5 & - &  x^4 & + & 2x^3 & + & x^2 & - & 1\\
- & 4x^5 &   &      & + & 4x^3 &   &     &   &  \\
= &      & - &  x^4 & - & 2x^3 & + & x^2 & - & 1
\end{array}
\end{equation}

We continue with
$-x^4$ and divide it by $x^2$, which is
$-x^2$. 
The overall result now is $4x^3 - x^2$.
We multiply $-x^2 \times (x^2 + 1) = -x^4 - x^2$
and subtract that from what remains from $a$:

\begin{equation}
\begin{array}{ccrcrcrcr}
  & - &  x^4 & - & 2x^3 & + &  x^2 & - & 1\\
- & - &  x^4 &   &      & - &  x^2 &   &  \\
= &   &      & - & 2x^3 & + & 2x^2 & - & 1
\end{array}
\end{equation}

We continue with $-2x^3$, which, divided by
$x^2$ is $-2x$. 
We multiply $-2x \times (x^2 + 1) = -2x^3 - 2x$
and subtract:

\begin{equation}
\begin{array}{ccrcrcrcr}
  & - & 2x^3 & + & 2x^2 & + &    & - & 1\\
- & - & 2x^3 &   &      & - & 2x &   &  \\
= &   &      &   & 2x^2 & + & 2x & - & 1 
\end{array}
\end{equation}

The result now is 
$4x^3 - x^2 - 2x$.
We continue with $2x^2$, which,
divided by $x^2$ is 2. 
We multiply $2\times (x^2 + 1) = 2x^2 + 2$
and subtract:

\begin{equation}
\begin{array}{ccrcrcrcr}
  & 2x^2 & + & 2x & - & 1\\
- & 2x^2 &   &    & + & 2\\
= &      &   & 2x & - & 3 
\end{array}
\end{equation}

The result now is
$4x^3 - x^2 - 2x + 2$.
We finally have $2x - 3$,
which is smaller in degree than $b$.
The result, hence, is
$(4x^3 - x^2 - 2x + 2, 2x - 3)$.

Here is an implementation of division in Haskell:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{20}{@{}>{\hspre}c<{\hspost}@{}}%
\column{20E}{@{}l@{}}%
\column{23}{@{}>{\hspre}l<{\hspost}@{}}%
\column{28}{@{}>{\hspre}l<{\hspost}@{}}%
\column{30}{@{}>{\hspre}l<{\hspost}@{}}%
\column{32}{@{}>{\hspre}c<{\hspost}@{}}%
\column{32E}{@{}l@{}}%
\column{35}{@{}>{\hspre}l<{\hspost}@{}}%
\column{43}{@{}>{\hspre}c<{\hspost}@{}}%
\column{43E}{@{}l@{}}%
\column{46}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{divp}\mathbin{::}{}\<[12]%
\>[12]{}(\Conid{Show}\;\Varid{a},\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a},\Conid{Fractional}\;\Varid{a},\Conid{Ord}\;\Varid{a})\Rightarrow {}\<[E]%
\\
\>[12]{}\Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}\to (\Conid{Poly}\;\Varid{a},\Conid{Poly}\;\Varid{a}){}\<[E]%
\\
\>[3]{}\Varid{divp}\;(\Conid{P}\;\Varid{as})\;(\Conid{P}\;\Varid{bs})\mathrel{=}\mathbf{let}\;(\Varid{q},\Varid{r})\mathrel{=}\Varid{go}\;[\mskip1.5mu \mskip1.5mu]\;\Varid{as}\;\mathbf{in}\;(\Conid{P}\;\Varid{q},\Conid{P}\;\Varid{r}){}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{db}\mathrel{=}\Varid{degree}\;(\Conid{P}\;\Varid{bs}){}\<[E]%
\\
\>[12]{}\Varid{go}\;\Varid{q}\;\Varid{r}{}\<[20]%
\>[20]{}\mid {}\<[20E]%
\>[23]{}\Varid{degree}\;(\Conid{P}\;\Varid{r})\mathbin{<}\Varid{db}{}\<[43]%
\>[43]{}\mathrel{=}{}\<[43E]%
\>[46]{}(\Varid{q},\Varid{r}){}\<[E]%
\\
\>[20]{}\mid {}\<[20E]%
\>[23]{}\Varid{null}\;\Varid{r}\mathrel{\vee}\Varid{r}\equiv [\mskip1.5mu \mathrm{0}\mskip1.5mu]{}\<[43]%
\>[43]{}\mathrel{=}{}\<[43E]%
\>[46]{}(\Varid{q},\Varid{r}){}\<[E]%
\\
\>[20]{}\mid {}\<[20E]%
\>[23]{}\Varid{otherwise}{}\<[43]%
\>[43]{}\mathrel{=}{}\<[43E]%
\\
\>[23]{}\mathbf{let}\;{}\<[28]%
\>[28]{}\Varid{t}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{last}\;\Varid{r}\mathbin{/}\Varid{last}\;\Varid{bs}{}\<[E]%
\\
\>[28]{}\Varid{d}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{degree}\;(\Conid{P}\;\Varid{r})\mathbin{-}\Varid{db}{}\<[E]%
\\
\>[28]{}\Varid{ts}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{zeros}\;\Varid{d}\plus [\mskip1.5mu \Varid{t}\mskip1.5mu]{}\<[E]%
\\
\>[28]{}\Varid{m}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{mulist}\;\Varid{ts}\;\Varid{bs}{}\<[E]%
\\
\>[23]{}\mathbf{in}\;\Varid{go}\;{}\<[30]%
\>[30]{}(\Varid{cleanz}\mathbin{\$}\Varid{strichlist}\;(\mathbin{+})\;\Varid{q}\;\Varid{ts})\;{}\<[E]%
\\
\>[30]{}(\Varid{cleanz}\mathbin{\$}\Varid{strichlist}\;(\mathbin{-})\;\Varid{r}\;\Varid{m}){}\<[E]%
\\[\blanklineskip]%
\>[3]{}\Varid{mulist}\mathbin{::}(\Conid{Show}\;\Varid{a},\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow [\mskip1.5mu \Varid{a}\mskip1.5mu]\to [\mskip1.5mu \Varid{a}\mskip1.5mu]\to [\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{mulist}\;\Varid{c1}\;\Varid{c2}\mathrel{=}\Varid{coeffs}\mathbin{\$}\Varid{mul}\;(\Conid{P}\;\Varid{c1})\;(\Conid{P}\;\Varid{c2}){}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

First note that division expects its arguments
to be polynomials over a \ensuremath{\Conid{Fractional}} data type.
We do not allow polynomials over integers to be used
with this implementation. The reason is that we do not
want to use Euclidean division on the coefficients.
That could indeed be very confusing. Furthermore,
polynomials are most often used with rational or real
coefficients. Restricting division to integers
(using Euclidean division) would, therefore, not make
much sense.

Observe further that we call \ensuremath{\Varid{go}} with an empty set --
that is the initial value of $q$, \ie\ the final result --
and $as$ -- that is initially the number to be divided,
the number we called $a$ above.
The function \ensuremath{\Varid{go}} has two base cases:
if the degree of $r$, the remainder and initially $as$,
is less than the degree of the divisor $b$, we are done.
The result is our current $(q,r)$. 
The same is true if $r$ is \ensuremath{\Varid{null}} or 
contains only the constant 0.
In this case, there is no remainder: $b$ divides $a$.

Otherwise, we divide the \ensuremath{\Varid{last}} of $r$ by the \ensuremath{\Varid{last}} of $b$.
Note that those are the term with the highest degree
in each polynomial.
This division is just a number division of the two
coefficients. We still have to compute the new exponent,
which is the exponent of \ensuremath{\Varid{last}\;\Varid{r}} minus the exponent of 
\ensuremath{\Varid{last}\;\Varid{b}}, \ie\ their weight. We do this by subtracting
their degrees and then inserting zeros 
at the head of the result \ensuremath{\Varid{ts}}.
This result, \ensuremath{\Varid{ts}}, is then added to $q$.
We further compute $ts \times bs$ and subtract
the result from $r$. The function \ensuremath{\Varid{mulist}} we use for this purpose
is just a wrapper around \ensuremath{\Varid{mul}} using
lists of coefficients instead of \ensuremath{\Conid{Poly}} variables.
With the resulting $(q,r)$, we go into the next round.

Let us try this with our example from above: 

\[
\frac{4x^5 - x^4 + 2x^3 + x^2 - 1}{x^2 + 1}.
\]

We call \ensuremath{\Varid{divp}\;(\Conid{P}\;[\mskip1.5mu \mathbin{-}\mathrm{1},\mathrm{0},\mathrm{1},\mathrm{2},\mathbin{-}\mathrm{1},\mathrm{4}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{0},\mathrm{1}\mskip1.5mu])} and get
\ensuremath{(\Conid{P}\;[\mskip1.5mu \mathrm{2},\mathbin{-}\mathrm{2},\mathbin{-}\mathrm{1},\mathrm{4}\mskip1.5mu],\Conid{P}\;[\mskip1.5mu \mathbin{-}\mathrm{3},\mathrm{2}\mskip1.5mu])}, which translates to the polynomials
$4x^3-x^2-2x+2$ and $2x - 3$. 
This is the same result we obtained above 
with the manual procedure.

From here on, we can implement functions based on division,
such as \ensuremath{\Varid{divides}}:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{15}{@{}>{\hspre}l<{\hspost}@{}}%
\column{18}{@{}>{\hspre}l<{\hspost}@{}}%
\column{29}{@{}>{\hspre}c<{\hspost}@{}}%
\column{29E}{@{}l@{}}%
\column{33}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{divides}\mathbin{::}{}\<[15]%
\>[15]{}(\Conid{Show}\;\Varid{a},\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a},\Conid{Ord}\;\Varid{a})\Rightarrow {}\<[E]%
\\
\>[15]{}\Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}\to \Conid{Bool}{}\<[E]%
\\
\>[3]{}\Varid{divides}\;\Varid{a}\;\Varid{b}\mathrel{=}{}\<[18]%
\>[18]{}\mathbf{case}\;\Varid{b}\mathbin{`\Varid{divp}`}{}\<[33]%
\>[33]{}\Varid{a}\;\mathbf{of}{}\<[E]%
\\
\>[18]{}(\anonymous ,\Conid{P}\;[\mskip1.5mu \mathrm{0}\mskip1.5mu]){}\<[29]%
\>[29]{}\to {}\<[29E]%
\>[33]{}\Conid{True}{}\<[E]%
\\
\>[18]{}\anonymous {}\<[29]%
\>[29]{}\to {}\<[29E]%
\>[33]{}\Conid{False}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

the remainder:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{15}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{remp}\mathbin{::}{}\<[12]%
\>[12]{}(\Conid{Show}\;\Varid{a},\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a},\Conid{Ord}\;\Varid{a})\Rightarrow {}\<[E]%
\\
\>[12]{}\Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}\to \Conid{Bool}{}\<[E]%
\\
\>[3]{}\Varid{remp}\;\Varid{a}\;\Varid{b}\mathrel{=}{}\<[15]%
\>[15]{}\mathbf{let}\;(\anonymous ,\Varid{r})\mathrel{=}\Varid{b}\mathbin{`\Varid{d}`}\Varid{a}\;\mathbf{in}\;\Varid{r}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

and, of course, the \acronym{gcd}:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{13}{@{}>{\hspre}c<{\hspost}@{}}%
\column{13E}{@{}l@{}}%
\column{16}{@{}>{\hspre}l<{\hspost}@{}}%
\column{27}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{gcdp}\mathbin{::}{}\<[12]%
\>[12]{}(\Conid{Show}\;\Varid{a},\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a},\Conid{Fractional}\;\Varid{a},\Conid{Ord}\;\Varid{a})\Rightarrow {}\<[E]%
\\
\>[12]{}\Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}\to \Conid{Poly}\;\Varid{a}{}\<[E]%
\\
\>[3]{}\Varid{gcdp}\;\Varid{a}\;\Varid{b}{}\<[13]%
\>[13]{}\mid {}\<[13E]%
\>[16]{}\Varid{degree}\;\Varid{b}\mathbin{>}\Varid{degree}\;\Varid{a}\mathrel{=}\Varid{gcdp}\;\Varid{b}\;\Varid{a}{}\<[E]%
\\
\>[13]{}\mid {}\<[13E]%
\>[16]{}\Varid{zerop}\;\Varid{b}{}\<[27]%
\>[27]{}\mathrel{=}\Varid{a}{}\<[E]%
\\
\>[13]{}\mid {}\<[13E]%
\>[16]{}\Varid{otherwise}{}\<[27]%
\>[27]{}\mathrel{=}\mathbf{let}\;(\anonymous ,\Varid{r})\mathrel{=}\Varid{divp}\;\Varid{a}\;\Varid{b}\;\mathbf{in}\;\Varid{gcdp}\;\Varid{b}\;\Varid{r}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

We use a simple function to check whether
a polynomial is zero:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{18}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{zerop}\mathbin{::}(\Conid{Num}\;\Varid{a},\Conid{Eq}\;\Varid{a})\Rightarrow \Conid{Poly}\;\Varid{a}\to \Conid{Bool}{}\<[E]%
\\
\>[3]{}\Varid{zerop}\;(\Conid{P}\;[\mskip1.5mu \mathrm{0}\mskip1.5mu]){}\<[18]%
\>[18]{}\mathrel{=}\Conid{True}{}\<[E]%
\\
\>[3]{}\Varid{zerpo}\;\anonymous {}\<[18]%
\>[18]{}\mathrel{=}\Conid{False}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

We can demonstrate \ensuremath{\Varid{gcdp}} nicely on binomial coefficients.
For instance, the \acronym{gcd} of the polynomials
$x^5 + 5x^4 + 10x^3 + 10x^2 + 5x + 1$ and
$x^3 + 3x^2 + 3x + 1$, thus

\ensuremath{\Varid{gcdp}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{5},\mathrm{10},\mathrm{10},\mathrm{5},\mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{3},\mathrm{3},\mathrm{1}\mskip1.5mu])}

is $x^3 + 3x^2 + 3x + 1$.

Since polynomials consisting of binomial coefficients of $n$,
where $n$ is the degree of the polynomial,
are always a product
of polynomials composed of smaller binomial coefficients
in the same way,
the \acronym{gcd} of two polynomials
consisting only of binomial coefficients,
is always the smaller of the two.
In other cases, that is, when the smaller does not divide
the greater, this implementation of the \acronym{gcd}
can lead to confusing results. For instance,
we multiply \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu]} by another polynomial, say,
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3}\mskip1.5mu]}. The result is \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{8},\mathrm{8},\mathrm{3}\mskip1.5mu]}. Now,

\ensuremath{\Varid{gcdp}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{5},\mathrm{10},\mathrm{10},\mathrm{5},\mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{8},\mathrm{8},\mathrm{3}\mskip1.5mu])}

does not yield the expected result \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu]}.
The reason is that the \acronym{gcd} is an operation
defined on integers, but we implemented it on top
of fractionals. That is often not what we want.
Anyway, here, we will actually use the \acronym{gcd} 
only in finite fields. 
Until now, we have discussed polynomials in infinite fields.
We now turn our attention to polynomial arithmetic
in a finite field and, hence, to modular polynomial arithmetic.

With modular arithmetic, all coefficients in the polynomial
are modulo $n$. That means we have to reduce those numbers.
This, of course, does only make sense with integers.
We first implement some helpers to reduce numbers modulo $n$
reusing functions implemented in the previous chapter.

The first function takes an integer modulo $n$:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{13}{@{}>{\hspre}c<{\hspost}@{}}%
\column{13E}{@{}l@{}}%
\column{16}{@{}>{\hspre}l<{\hspost}@{}}%
\column{35}{@{}>{\hspre}c<{\hspost}@{}}%
\column{35E}{@{}l@{}}%
\column{38}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{mmod}\mathbin{::}\Conid{Zahl}\to \Conid{Zahl}\to \Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{mmod}\;\Varid{n}\;\Varid{p}{}\<[13]%
\>[13]{}\mid {}\<[13E]%
\>[16]{}\Varid{n}\mathbin{<}\mathrm{0}\mathrel{\wedge}(\mathbin{-}\Varid{n})\mathbin{>}\Varid{p}{}\<[35]%
\>[35]{}\mathrel{=}{}\<[35E]%
\>[38]{}\Varid{mmod}\;(\mathbin{-}(\Varid{mmod}\;(\mathbin{-}\Varid{n}))\;\Varid{p})\;\Varid{p}{}\<[E]%
\\
\>[13]{}\mid {}\<[13E]%
\>[16]{}\Varid{n}\mathbin{<}\mathrm{0}{}\<[35]%
\>[35]{}\mathrel{=}{}\<[35E]%
\>[38]{}\Varid{mmod}\;(\Varid{p}\mathbin{+}\Varid{n})\;\Varid{p}{}\<[E]%
\\
\>[13]{}\mid {}\<[13E]%
\>[16]{}\Varid{otherwise}{}\<[35]%
\>[35]{}\mathrel{=}{}\<[35E]%
\>[38]{}\Varid{n}\mathbin{\Varid{`rem`}}\Varid{p}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

Equipped with this function, we can easily implement multiplication:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{modmul}\mathbin{::}\Conid{Zahl}\to \Conid{Zahl}\to \Conid{Zahl}\to \Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{modmul}\;\Varid{p}\;\Varid{f1}\;\Varid{f2}\mathrel{=}(\Varid{f1}\mathbin{*}\Varid{f2})\mathbin{`\Varid{mmod}`}\Varid{p}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

For division, we reuse the \ensuremath{\Varid{inverse}} function:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{modiv}\mathbin{::}\Conid{Zahl}\to \Conid{Zahl}\to \Conid{Zahl}\to \Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{modiv}\;\Varid{p}\;\Varid{n}\;\Varid{d}\mathrel{=}\Varid{modmul}\;\Varid{p}\;\Varid{n}\;\Varid{d'}{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;\Varid{d'}\mathrel{=}\Varid{\Conid{M}.inverse}\;\Varid{d}\;\Varid{p}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

Now, we turn to polynomials. Here is, first, a function
that transforms a polynomial into one modulo $n$:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{pmod}\mathbin{::}\Conid{Poly}\;\Conid{Zahl}\to \Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{pmod}\;(\Conid{P}\;\Varid{cs})\;\Varid{p}\mathrel{=}\Conid{P}\;[\mskip1.5mu \Varid{c}\mathbin{`\Varid{mmod}`}\Varid{p}\mid \Varid{c}\leftarrow \Varid{cs}\mskip1.5mu]{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

In other words, we just map \ensuremath{\Varid{mmod}} on all coefficients.
Let us look at some polynomials modulo a number, say, 7.
The polynomial \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu]}
we already used above is just the same modulo 7.
The polynomial \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu]}, however, changes:

\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu]\mathbin{`\Varid{pmod}`}\mathrm{7}}

is \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{0},\mathrm{1}\mskip1.5mu]} or, in other words,
$8x^3 + 7x^2 + 6x + 5$ turns, modulo 7, into 
$x^3 + 6x + 5$.

The polynomial $x + 1$ raised to the power of 5 is
$x^5 + 5x^4 + 10x^3 + 10x^2 + 5x + 1$. Modulo 7, this
reduces to $x^5 + 5x^4 + 3x^3 + 3x^3 + 5x + 1$.
That is: the binomial coefficients modulo $n$ change.
For instance,

\ensuremath{\Varid{map}\;(\Varid{choose2}\;\mathrm{6})\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mathrm{6}\mskip1.5mu]}

is

1,6,15,20,15,6,1.

Modulo 7, we get

1,6,1,6,1,6,1.

\ensuremath{\Varid{map}\;(\Varid{choose2}\;\mathrm{7})\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mathrm{7}\mskip1.5mu]}

is

1,7,21,35,35,21,7,1.

Without big surprise, we see this modulo 7
drastically simplified:

1,0,0,0,0,0,0,1.

Here are addition and subtraction, which are very easy
to convert to modular arithmetic:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{addmp}\mathbin{::}\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{addmp}\;\Varid{n}\;\Varid{p1}\;\Varid{p2}\mathrel{=}\Varid{strich}\;(\mathbin{+})\;\Varid{p1}\;\Varid{p2}\mathbin{`\Varid{pmod}`}\Varid{n}{}\<[E]%
\\
\>[3]{}\Varid{submp}\mathbin{::}\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{submp}\;\Varid{n}\;\Varid{p1}\;\Varid{p2}\mathrel{=}\Varid{strich}\;(\mathbin{-})\;\Varid{p1}\;\Varid{p2}\mathbin{`\Varid{pmod}`}\Varid{n}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

Multiplication:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{16}{@{}>{\hspre}c<{\hspost}@{}}%
\column{16E}{@{}l@{}}%
\column{18}{@{}>{\hspre}c<{\hspost}@{}}%
\column{18E}{@{}l@{}}%
\column{19}{@{}>{\hspre}l<{\hspost}@{}}%
\column{21}{@{}>{\hspre}l<{\hspost}@{}}%
\column{32}{@{}>{\hspre}c<{\hspost}@{}}%
\column{32E}{@{}l@{}}%
\column{35}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{mulmp}\mathbin{::}\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{mulmp}\;\Varid{p}\;\Varid{p1}\;\Varid{p2}{}\<[18]%
\>[18]{}\mid {}\<[18E]%
\>[21]{}\Varid{d2}\mathbin{>}\Varid{d1}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{mulmp}\;\Varid{p}\;\Varid{p2}\;\Varid{p1}{}\<[E]%
\\
\>[18]{}\mid {}\<[18E]%
\>[21]{}\Varid{otherwise}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Conid{P}\;[\mskip1.5mu \Varid{m}\mathbin{`\Varid{mmod}`}\Varid{p}\mid \Varid{m}\leftarrow \Varid{strichf}\;(\mathbin{+})\;\Varid{ms}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{ms}{}\<[16]%
\>[16]{}\mathrel{=}{}\<[16E]%
\>[19]{}[\mskip1.5mu \Varid{mul1}\;\Varid{o}\;\Varid{i}\;(\Varid{coeffs}\;\Varid{p1})\;\Varid{c}\mid (\Varid{i},\Varid{c})\leftarrow \Varid{zip}\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mskip1.5mu]\;(\Varid{coeffs}\;\Varid{p2})\mskip1.5mu]{}\<[E]%
\\
\>[12]{}\Varid{d1}{}\<[16]%
\>[16]{}\mathrel{=}{}\<[16E]%
\>[19]{}\Varid{degree}\;\Varid{p1}{}\<[E]%
\\
\>[12]{}\Varid{d2}{}\<[16]%
\>[16]{}\mathrel{=}{}\<[16E]%
\>[19]{}\Varid{degree}\;\Varid{p2}{}\<[E]%
\\
\>[12]{}\Varid{o}{}\<[16]%
\>[16]{}\mathrel{=}{}\<[16E]%
\>[19]{}\Varid{modmul}\;\Varid{p}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

We repeat the multiplication from above 

\ensuremath{\Varid{mul}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu])} 

which was

\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{16},\mathrm{34},\mathrm{60},\mathrm{61},\mathrm{52},\mathrm{32}\mskip1.5mu]}

Modulo 7, this result is

\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{2},\mathrm{6},\mathrm{4},\mathrm{5},\mathrm{3},\mathrm{4}\mskip1.5mu]}.

The modulo multiplication

\ensuremath{\Varid{mulmp}\;\mathrm{7}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{0},\mathrm{1}\mskip1.5mu])}

yields the same result:

\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{2},\mathrm{6},\mathrm{4},\mathrm{5},\mathrm{3},\mathrm{4}\mskip1.5mu]}

Division:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{20}{@{}>{\hspre}c<{\hspost}@{}}%
\column{20E}{@{}l@{}}%
\column{23}{@{}>{\hspre}l<{\hspost}@{}}%
\column{28}{@{}>{\hspre}l<{\hspost}@{}}%
\column{30}{@{}>{\hspre}l<{\hspost}@{}}%
\column{32}{@{}>{\hspre}c<{\hspost}@{}}%
\column{32E}{@{}l@{}}%
\column{35}{@{}>{\hspre}l<{\hspost}@{}}%
\column{43}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{divmp}\mathbin{::}\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to (\Conid{Poly}\;\Conid{Zahl},\Conid{Poly}\;\Conid{Zahl}){}\<[E]%
\\
\>[3]{}\Varid{divmp}\;\Varid{p}\;(\Conid{P}\;\Varid{as})\;(\Conid{P}\;\Varid{bs})\mathrel{=}\mathbf{let}\;(\Varid{q},\Varid{r})\mathrel{=}\Varid{go}\;[\mskip1.5mu \mathrm{0}\mskip1.5mu]\;\Varid{as}\;\mathbf{in}\;(\Conid{P}\;\Varid{q},\Conid{P}\;\Varid{r}){}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{db}\mathrel{=}\Varid{degree}\;(\Conid{P}\;\Varid{bs}){}\<[E]%
\\
\>[12]{}\Varid{go}\;\Varid{q}\;\Varid{r}{}\<[20]%
\>[20]{}\mid {}\<[20E]%
\>[23]{}\Varid{degree}\;(\Conid{P}\;\Varid{r})\mathbin{<}\Varid{db}{}\<[43]%
\>[43]{}\mathrel{=}(\Varid{q},\Varid{r}){}\<[E]%
\\
\>[20]{}\mid {}\<[20E]%
\>[23]{}\Varid{null}\;\Varid{r}\mathrel{\vee}\Varid{r}\equiv [\mskip1.5mu \mathrm{0}\mskip1.5mu]{}\<[43]%
\>[43]{}\mathrel{=}(\Varid{q},\Varid{r}){}\<[E]%
\\
\>[20]{}\mid {}\<[20E]%
\>[23]{}\Varid{otherwise}{}\<[43]%
\>[43]{}\mathrel{=}{}\<[E]%
\\
\>[23]{}\mathbf{let}\;{}\<[28]%
\>[28]{}\Varid{t}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{modiv}\;\Varid{p}\;(\Varid{last}\;\Varid{r})\;(\Varid{last}\;\Varid{bs}){}\<[E]%
\\
\>[28]{}\Varid{d}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{degree}\;(\Conid{P}\;\Varid{r})\mathbin{-}\Varid{db}{}\<[E]%
\\
\>[28]{}\Varid{ts}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{zeros}\;\Varid{d}\plus [\mskip1.5mu \Varid{t}\mskip1.5mu]{}\<[E]%
\\
\>[28]{}\Varid{m}{}\<[32]%
\>[32]{}\mathrel{=}{}\<[32E]%
\>[35]{}\Varid{mulmlist}\;\Varid{p}\;\Varid{ts}\;\Varid{bs}{}\<[E]%
\\
\>[23]{}\mathbf{in}\;\Varid{go}\;{}\<[30]%
\>[30]{}[\mskip1.5mu \Varid{c}\mathbin{`\Varid{mmod}`}\Varid{p}\mid \Varid{c}\leftarrow \Varid{cleanz}\mathbin{\$}\Varid{strichlist}\;(\mathbin{+})\;\Varid{q}\;\Varid{ts}\mskip1.5mu]\;{}\<[E]%
\\
\>[30]{}[\mskip1.5mu \Varid{c}\mathbin{`\Varid{mmod}`}\Varid{p}\mid \Varid{c}\leftarrow \Varid{cleanz}\mathbin{\$}\Varid{strichlist}\;(\mathbin{-})\;\Varid{r}\;\Varid{m}\mskip1.5mu]{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

\acronym{gcd}:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{16}{@{}>{\hspre}c<{\hspost}@{}}%
\column{16E}{@{}l@{}}%
\column{19}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{gcdmp}\mathbin{::}\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{gcdmp}\;\Varid{p}\;\Varid{a}\;\Varid{b}{}\<[16]%
\>[16]{}\mid {}\<[16E]%
\>[19]{}\Varid{degree}\;\Varid{b}\mathbin{>}\Varid{degree}\;\Varid{a}\mathrel{=}\Varid{gcdmp}\;\Varid{p}\;\Varid{b}\;\Varid{a}{}\<[E]%
\\
\>[16]{}\mid {}\<[16E]%
\>[19]{}\Varid{zerop}\;\Varid{b}\mathrel{=}\Varid{a}{}\<[E]%
\\
\>[16]{}\mid {}\<[16E]%
\>[19]{}\Varid{otherwise}\mathrel{=}\mathbf{let}\;(\anonymous ,\Varid{r})\mathrel{=}\Varid{divmp}\;\Varid{p}\;\Varid{a}\;\Varid{b}\;\mathbf{in}\;\Varid{gcdmp}\;\Varid{p}\;\Varid{b}\;\Varid{r}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

Let us try \ensuremath{\Varid{gcdmp}} on the variation we already tested above. 
We multiply the polynomial
$x^2 + 2x + 1$ by $3x^2 + 2x + 1$ modulo 7:

\ensuremath{\Varid{mulmp}\;\mathrm{7}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3}\mskip1.5mu])}.

The result is \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{1},\mathrm{1},\mathrm{3}\mskip1.5mu]}.

Now, we compute the \acronym{gcd} with \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{5},\mathrm{10},\mathrm{10},\mathrm{5},\mathrm{1}\mskip1.5mu]} modulo 7:

\ensuremath{\Varid{gcdmp}\;\mathrm{7}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{5},\mathrm{3},\mathrm{3},\mathrm{5},\mathrm{1}\mskip1.5mu])\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{1},\mathrm{1},\mathrm{3}\mskip1.5mu])}.

The result is \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu]}, as expected.

Finally, power:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{22}{@{}>{\hspre}l<{\hspost}@{}}%
\column{35}{@{}>{\hspre}c<{\hspost}@{}}%
\column{35E}{@{}l@{}}%
\column{38}{@{}>{\hspre}l<{\hspost}@{}}%
\column{58}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{powmp}\mathbin{::}\Conid{Zahl}\to \Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}\to \Conid{Poly}\;\Conid{Zahl}{}\<[E]%
\\
\>[3]{}\Varid{powmp}\;\Varid{p}\;\Varid{f}\;\Varid{poly}\mathrel{=}\Varid{go}\;\Varid{f}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1}\mskip1.5mu])\;\Varid{poly}{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{go}\;\mathrm{0}\;\Varid{y}\;\anonymous {}\<[22]%
\>[22]{}\mathrel{=}\Varid{y}{}\<[E]%
\\
\>[12]{}\Varid{go}\;\mathrm{1}\;\Varid{y}\;\Varid{x}{}\<[22]%
\>[22]{}\mathrel{=}\Varid{mulmp}\;\Varid{p}\;\Varid{y}\;\Varid{x}{}\<[E]%
\\
\>[12]{}\Varid{go}\;\Varid{n}\;\Varid{y}\;\Varid{x}{}\<[22]%
\>[22]{}\mid \Varid{even}\;\Varid{n}{}\<[35]%
\>[35]{}\mathrel{=}{}\<[35E]%
\>[38]{}\Varid{go}\;(\Varid{n}\mathbin{\Varid{`div`}}\mathrm{2})\;\Varid{y}\;{}\<[58]%
\>[58]{}(\Varid{mulmp}\;\Varid{p}\;\Varid{x}\;\Varid{x}){}\<[E]%
\\
\>[22]{}\mid \Varid{otherwise}{}\<[35]%
\>[35]{}\mathrel{=}{}\<[35E]%
\>[38]{}\Varid{go}\;((\Varid{n}\mathbin{-}\mathrm{1})\mathbin{\Varid{`div`}}\mathrm{2})\;{}\<[58]%
\>[58]{}(\Varid{mulmp}\;\Varid{p}\;\Varid{y}\;\Varid{x})\;{}\<[E]%
\\
\>[58]{}(\Varid{mulmp}\;\Varid{p}\;\Varid{x}\;\Varid{x}){}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

Here is a nice variant of Pascal's triangle generated by
\ensuremath{\Varid{map}\;(\lambda \Varid{x}\to \Varid{powmp}\;\mathrm{7}\;\Varid{x}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;[\mskip1.5mu \mathrm{1}\mathinner{\ldotp\ldotp}\mathrm{14}\mskip1.5mu]}:

\begin{minipage}{\textwidth}
\begin{center}
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{3},\mathrm{3},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{6},\mathrm{4},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{5},\mathrm{3},\mathrm{3},\mathrm{5},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{6},\mathrm{1},\mathrm{6},\mathrm{1},\mathrm{6},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{1},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{3},\mathrm{3},\mathrm{1},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{1},\mathrm{3},\mathrm{3},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{6},\mathrm{4},\mathrm{1},\mathrm{0},\mathrm{0},\mathrm{1},\mathrm{4},\mathrm{6},\mathrm{4},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{5},\mathrm{3},\mathrm{3},\mathrm{5},\mathrm{1},\mathrm{0},\mathrm{1},\mathrm{5},\mathrm{3},\mathrm{3},\mathrm{5},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{6},\mathrm{1},\mathrm{6},\mathrm{1},\mathrm{6},\mathrm{1},\mathrm{1},\mathrm{6},\mathrm{1},\mathrm{6},\mathrm{1},\mathrm{6},\mathrm{1}\mskip1.5mu]}\\
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{2},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{0},\mathrm{1}\mskip1.5mu]}
\end{center}
\end{minipage}

It is especially interesting to look at greater powers 
using exponents that are multiples of 7.
Before we continue with modular arithmetic,
which we need indeed to understand some of the deeper problems
related to polynomials, we will
investigate the application of polynomials using a famous device: 
Babbage's difference engine.
\section{The Difference Engine}
\ignore{
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[B]{}\mathbf{module}\;\Conid{PolyArith}{}\<[E]%
\\
\>[B]{}\mathbf{where}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Natural}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Zahl}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Quoz}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{Real}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{NumSystem}{}\<[E]%
\\
\>[B]{}\hsindent{3}{}\<[3]%
\>[3]{}\mathbf{import}\;\Conid{PolyArith}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
}

Polynomial arithmetic, as we have seen,
is very similar to number arithmetic.
What is the correspondent of interpreting
a number in a given numeral system
in the domain of polynomials?
Well, that is the \term{application} of the polynomial
to a given number. We would substitute $x$
for a number in the Field in which we are working
and just compute the formula.
For instance, the polynomial

\[
x^2 + x + 1
\]

can be applied to a rational number, say, 2.
Then we get the formula

\[
2^2 + 2 + 1,
\]

which is $4 + 2 + 1 = 7$.

For other values of $x$, it would of course
generate other values. For $x=0$, for instance,
it would give $0^2 + 0 + 1 = 1$; for $x=1$,
it give $1^2 + 1 + 1 = 3$; for $x=3$, it yields
$3^2 + 3 + 1 = 13$.

How do we need to do to apply a polynomial represented
by our Haskell type? Wee need to go through the list
of coefficients, raise $x$ to the power of the weight
of each particular coefficient, multiply it by the coefficient
and, finally, add all the values together.
Here is an implementation:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{5}{@{}>{\hspre}l<{\hspost}@{}}%
\column{12}{@{}>{\hspre}l<{\hspost}@{}}%
\column{21}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{apply}\mathbin{::}\Conid{Num}\;\Varid{a}{}\<[21]%
\>[21]{}\Rightarrow \Conid{Poly}\;\Varid{a}\to \Varid{a}\to \Varid{a}{}\<[E]%
\\
\>[3]{}\Varid{apply}\;(\Conid{P}\;[\mskip1.5mu \mskip1.5mu])\;\anonymous {}\<[21]%
\>[21]{}\mathrel{=}\mathrm{0}{}\<[E]%
\\
\>[3]{}\Varid{apply}\;(\Conid{P}\;\Varid{as})\;\Varid{x}{}\<[21]%
\>[21]{}\mathrel{=}\Varid{go}\;\Varid{x}\mathbin{\$}\Varid{zip}\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mskip1.5mu]\;\Varid{as}{}\<[E]%
\\
\>[3]{}\hsindent{2}{}\<[5]%
\>[5]{}\mathbf{where}\;{}\<[12]%
\>[12]{}\Varid{go}\;\anonymous \;[\mskip1.5mu \mskip1.5mu]{}\<[21]%
\>[21]{}\mathrel{=}\mathrm{0}{}\<[E]%
\\
\>[12]{}\Varid{go}\;\Varid{z}\;((\Varid{i},\Varid{c})\mathbin{:}\Varid{cs})\mathrel{=}\Varid{c}\mathbin{*}\Varid{z}\mathbin{\uparrow}\Varid{i}\mathbin{+}\Varid{go}\;\Varid{z}\;\Varid{cs}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

First, we weigh the coefficients by zipping them
with the list of integers starting from 0 and then
we apply \ensuremath{\Varid{go}}. 
We define the base case of \ensuremath{\Varid{go}},
as the one where the coefficients are exhausted. 
Otherwise, we raise $z$ (that is the number 
to which we apply the polynomial) to the current
weight and multiply the coefficient.
We continue by adding this result to the result
of apply \ensuremath{\Varid{go}} to the remainder of the list.
Let us try with a very simple polynomial, $x + 1$:

\begin{minipage}{\textwidth}
\ensuremath{\Varid{apply}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;\mathrm{0}} gives 1.\\
\ensuremath{\Varid{apply}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;\mathrm{1}} gives 2.\\
\ensuremath{\Varid{apply}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;\mathrm{2}} gives 3.\\
\ensuremath{\Varid{apply}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu])\;\mathrm{3}} gives 4.
\end{minipage}

This polynomial, apparently, just counts the integers
adding one to the value to which we apply it.
It implements {\texttt i++}.

On the first sight, this result appears to be boring.
However, after a quick thought, there is a lesson to learn:
we learn something about the polynomial, when we look
at the \term{sequence} it produces when applied
to a sequence of numbers. So, let us implement
a function that maps \ensuremath{\Varid{apply}} to lists of numbers:

\begin{minipage}{\textwidth}
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{3}{@{}>{\hspre}l<{\hspost}@{}}%
\column{22}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[3]{}\Varid{mapply}\mathbin{::}\Conid{Num}\;\Varid{a}{}\<[22]%
\>[22]{}\Rightarrow \Conid{Poly}\;\Varid{a}\to [\mskip1.5mu \Varid{a}\mskip1.5mu]\to [\mskip1.5mu \Varid{a}\mskip1.5mu]{}\<[E]%
\\
\>[3]{}\Varid{mapply}\;\Varid{p}\mathrel{=}\Varid{map}\;(\Varid{apply}\;\Varid{p}){}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
\end{minipage}

For simple polynomials, the sequences are predictable.
$x^2$, obviously, just produces the squares;
$x^3$ produces the cubes and so on.
Sequences created by powers of the simple polynomial $x+1$,
however, are not so predictable anymore (or are they?), \eg\:

\begin{minipage}{\textwidth}
\ensuremath{\Varid{mapply}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu])\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mathrm{10}\mskip1.5mu]}: 1,4,9,16,25,36,49,64,81,100,121\\
\ensuremath{\Varid{mapply}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{3},\mathrm{3},\mathrm{1}\mskip1.5mu])\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mathrm{10}\mskip1.5mu]}: 1,8,27,64,125,216,343,512,729,1000,1331\\
\ensuremath{\Varid{mapply}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{4},\mathrm{6},\mathrm{4},\mathrm{1}\mskip1.5mu])\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mathrm{10}\mskip1.5mu]}: 1,16,81,256,625,1296,2401,4096,6561,10000,14641\\
\ensuremath{\Varid{mapply}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{5},\mathrm{10},\mathrm{10},\mathrm{5},\mathrm{1}\mskip1.5mu])\;[\mskip1.5mu \mathrm{0}\mathinner{\ldotp\ldotp}\mathrm{10}\mskip1.5mu]}:\\
1,32,243,1024,3125,7776,16807,32768,59049,100000,161051\\
\end{minipage}

The first, easy to recognise, are the squares, but pushed one up,
\ie\ the application to 0 yields the value for $1^2$, 
the application to 1 yields the value for $2^2$ and so on.
The second, still easy to recognise,
are the cubes -- again pushed up by one.
The third are the powers of four and the fourth are the powers of five.

That is not too surprising at the end, since
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{1}\mskip1.5mu]} is the result of squaring \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu]}, 
which generates the integers pushed one up;
\ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{3},\mathrm{3},\mathrm{1}\mskip1.5mu]} is the result of raising \ensuremath{\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{1}\mskip1.5mu]} to the third power
and so on.

Things become more interesting, when we deviate
from the binomial coefficients. The sequence
produced by \ensuremath{\Varid{mappy}\;(\Conid{P}\;[\mskip1.5mu \mathrm{1},\mathrm{2},\mathrm{3},\mathrm{4}\mskip1.5mu])\;[\mskip1.5mu \mathrm{1}\mathinner{\ldotp\ldotp}\mathrm{10}\mskip1.5mu]}, for instance,
does not resemble such a simple sequence:
1, 10, 49, 142, 313, 586, 985, 1534, 2257, 3178, 4321.
Even the Online Encyclopedia has nothing interesting
to say about it.
The same is true for \ensuremath{\Varid{mappy}\;(\Conid{P}\;[\mskip1.5mu \mathrm{5},\mathrm{6},\mathrm{7},\mathrm{8}\mskip1.5mu])\;[\mskip1.5mu \mathrm{1}\mathinner{\ldotp\ldotp}\mathrm{10}\mskip1.5mu]},
which is 5, 26, 109, 302, 653, 1210, 2021, 3134, 4597, 6458, 8765.

This raises another interesting question:
given a sequence, is there a method by which 
we can we recognise the polynomial that created it?
Yes, there is. In fact, there are.
There was even a machine that helped in guessing
polynomials from sequences. It was built in the early
$19^{th}$ century by Charles Babbage (1791 -- 1871),
an English polymath, mathematician, philosopher,
economist, and inventor.

Babbage stands in the tradition of designers and constructors
of early computing machinery; predecessors of his
in this tradition were, for instance, 
Blaise Pascal (1623 -- 1662) and
Gottfried Wilhelm Leibniz (1646 -- 1716).
Babbage designed two series of machines,
first, the difference engines and, later, 
the analytical engine.

The analytical engine, unfortunately, was not built in his lifetime.
Only more than a century after the final collapse of the project
in 1878 due to lack of finance, the machine was built 
by science historians and,
this way, it was proved that it was actually possible
to build such a machine with the technology available
in Babbage's time.
The analytical engine would have been 
a universal (Turing-complete) computer
very similar to our computers today,
but not working on electricity, but on steam.
It would have been programmed by punch cards that,
in Babbage's time, were used for controlling looms.
Programs would have resembled modern assembly languages
allowing control structures like selections and iterations.
In the context of a description of the analytical engine,
Ada Lovelace, a friend of Babbage and daughter of Lord Byron,
described how to compute Bernoulli numbers with the machine.
She is, therefore, considered the first computer programmer
in history.

The difference engine, at which we will look here,
is much simpler. It was designed to analyse polynomials
and what it did was, according to Babbage, ``computing differences''.



\ignore{
- Charles Babbage
- compute differences
- compute degree
- predict next
- derivative
- guess the polynomial
}

\section{Polynomials and Binomial Coefficients}
\section{Roots}
\section{Vieta's Formula}
\section{The Method of partial Fractions}
\ignore{
http://www.purplemath.com/modules/partfrac.htm
}
\section{Generationfunctionology 1}
\section{The closed Form of the Fibonacci Sequence}
\ignore{
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[B]{}\mathbf{module}\;\Conid{ClosedFib}{}\<[E]%
\\
\>[B]{}\mathbf{where}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
}

\begin{equation}
G(x) = F_0 + F_1x + F_2x^2 + F_3x^3 + \dots
\end{equation}

\begin{equation}
G(x) = 0 + x + x^2 + 2x^3 + 3x^4 + 5x^5 + 8x^6 + \dots
\end{equation}

\begin{equation}
xG(x) = F_0x + F_1x^2 + F_2x^3 + F_3x^4 + \dots
\end{equation}

\begin{equation}
x^2G(x) = F_0x^2 + F_1x^3 + F_2x^4 + F_3x^5 + \dots
\end{equation}

\begin{equation}
G(x) - xG(x) - x^2G(x) = (1-x-x^2)G(x).
\end{equation}

\begin{align*}
(1-x-x^2)G(x) & = & (&F_0 & + & F_1x & + & F_2x^2 & + & F_3x^3 & + & \dots) & - \\
              &   & (&    &   & F_0x & + & F_1x^2 & + & F_2x^3 & + & \dots) & - \\
              &   & (&    &   &      & + & F_0x^2 & + & F_1x^3 & + & \dots) &
\end{align*}

\begin{align*}
(1-x-x^2)G(x) & = & F_0 & + (F_1 - F_0)x \\
              &   &     & + (F_2 - F_1 - F_0)x^2 \\
              &   &     & + (F_3 - F_2 - F_1)x^3 \\
              &   &     & + \dots
\end{align*}

\begin{equation}
(1-x-x^2)G(x) = x.
\end{equation}

\begin{equation}
G(x) = \frac{x}{1-x-x^2}.
\end{equation}

\ignore{
- factor denominator using roots:
  - (x+1/2+sqrt(5)/2) 
  - (x+1/2-sqrt(5)/2)
- then use partial fractions
}



\section{Factoring Polynomials}


\end{document}
