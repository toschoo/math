%% =======================================================
%% (c) Tobias Schoofs
%% =======================================================
%% Math 4 Programmers - The Inverse Element
%% =======================================================

% Plain Style
\documentclass[tikz]{scrreprt}

%% ODER: format ==         = "\mathrel{==}"
%% ODER: format /=         = "\neq "
%
%
\makeatletter
\@ifundefined{lhs2tex.lhs2tex.sty.read}%
  {\@namedef{lhs2tex.lhs2tex.sty.read}{}%
   \newcommand\SkipToFmtEnd{}%
   \newcommand\EndFmtInput{}%
   \long\def\SkipToFmtEnd#1\EndFmtInput{}%
  }\SkipToFmtEnd

\newcommand\ReadOnlyOnce[1]{\@ifundefined{#1}{\@namedef{#1}{}}\SkipToFmtEnd}
\usepackage{amstext}
\usepackage{amssymb}
\usepackage{stmaryrd}
\DeclareFontFamily{OT1}{cmtex}{}
\DeclareFontShape{OT1}{cmtex}{m}{n}
  {<5><6><7><8>cmtex8
   <9>cmtex9
   <10><10.95><12><14.4><17.28><20.74><24.88>cmtex10}{}
\DeclareFontShape{OT1}{cmtex}{m}{it}
  {<-> ssub * cmtt/m/it}{}
\newcommand{\texfamily}{\fontfamily{cmtex}\selectfont}
\DeclareFontShape{OT1}{cmtt}{bx}{n}
  {<5><6><7><8>cmtt8
   <9>cmbtt9
   <10><10.95><12><14.4><17.28><20.74><24.88>cmbtt10}{}
\DeclareFontShape{OT1}{cmtex}{bx}{n}
  {<-> ssub * cmtt/bx/n}{}
\newcommand{\tex}[1]{\text{\texfamily#1}}	% NEU

\newcommand{\Sp}{\hskip.33334em\relax}


\newcommand{\Conid}[1]{\mathit{#1}}
\newcommand{\Varid}[1]{\mathit{#1}}
\newcommand{\anonymous}{\kern0.06em \vbox{\hrule\@width.5em}}
\newcommand{\plus}{\mathbin{+\!\!\!+}}
\newcommand{\bind}{\mathbin{>\!\!\!>\mkern-6.7mu=}}
\newcommand{\rbind}{\mathbin{=\mkern-6.7mu<\!\!\!<}}% suggested by Neil Mitchell
\newcommand{\sequ}{\mathbin{>\!\!\!>}}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\usepackage{polytable}

%mathindent has to be defined
\@ifundefined{mathindent}%
  {\newdimen\mathindent\mathindent\leftmargini}%
  {}%

\def\resethooks{%
  \global\let\SaveRestoreHook\empty
  \global\let\ColumnHook\empty}
\newcommand*{\savecolumns}[1][default]%
  {\g@addto@macro\SaveRestoreHook{\savecolumns[#1]}}
\newcommand*{\restorecolumns}[1][default]%
  {\g@addto@macro\SaveRestoreHook{\restorecolumns[#1]}}
\newcommand*{\aligncolumn}[2]%
  {\g@addto@macro\ColumnHook{\column{#1}{#2}}}

\resethooks

\newcommand{\onelinecommentchars}{\quad-{}- }
\newcommand{\commentbeginchars}{\enskip\{-}
\newcommand{\commentendchars}{-\}\enskip}

\newcommand{\visiblecomments}{%
  \let\onelinecomment=\onelinecommentchars
  \let\commentbegin=\commentbeginchars
  \let\commentend=\commentendchars}

\newcommand{\invisiblecomments}{%
  \let\onelinecomment=\empty
  \let\commentbegin=\empty
  \let\commentend=\empty}

\visiblecomments

\newlength{\blanklineskip}
\setlength{\blanklineskip}{0.66084ex}

\newcommand{\hsindent}[1]{\quad}% default is fixed indentation
\let\hspre\empty
\let\hspost\empty
\newcommand{\NB}{\textbf{NB}}
\newcommand{\Todo}[1]{$\langle$\textbf{To do:}~#1$\rangle$}

\EndFmtInput
\makeatother
%

\include{cmds}

\begin{document}
\setlength{\parindent}{0pt}
\setlength{\parskip}{8pt}

\chapter{Elliptic Curves} % c10
\section{Geometry Intuition} 
\ignore{
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[B]{}\mathbf{module}\;\Conid{ECGeometry}{}\<[E]%
\\
\>[B]{}\mathbf{where}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
}

Before we go on with more theoretical topics,
let us examine another application of the quite
abstract theory of algebra we have studied
in the previous chapters, namely 
elliptic curve cryptography. It should be
mentioned that linear algebra is by far 
not the only topic relevant in this context.
In fact, important aspects of the theory
of elliptic curves require the understanding
of function analysis -- where it actually
comes from -- but here we will focus on 
algebra and group theory.

Elliptic Curves (\acronym{ec}) provide the mathematical
background for variants of public key cryptography.
This kind of cryptography is being developed
since the eighties, but it took a while until it
was accepted by the industry. 
Today, however, it is the 
main public key cryptography scheme around.
Its acceptance was accelerated by the smartphone boom.
In smartphones and other devices with restricited
resources, classic cryptographic schemes are not
very practical. Their drawback is
the computational overhead resulting from key size.
Cryptoanalytic attacks forced classic schemes
to be used with huge keys. To achieve 128-bit security 
with \acronym{rsa}, for instance, we need keys with at least
\num{3072} bits. The same level of security
can be reached with \acronym{ec} cryptography, 
according to known attacks today,
with 256 bits. A huge improvement!

\acronym{ec} cryptography is different from
classic cryptography in various respects.
First, it includes much more math.
That is to say, it does not include 
theory from only one or two branches
of mathematics like number theory
in classic cryptography,
but from many different branches.
This has huge impact on cryptoanalysis.
Hidden attacks may lurk
in apparently remote fields of mathematics
that we did not account for.
However, the theory surrounding \acronym{ec}
is very well understood today and, as said,
it is the mainline cryptography approach today.

Second, the basic means, especially the group
we need for public key cryptography, are
much more ``engineered'' than in classic
cryptography. Classic schemes are based
mainly on modular arithmetic, which was
well known centuries before anyone thought
of this use case. The groups found in modular
arithmetic, in particular the multiplicative
group, was then used to define cryptographic tools.
In elliptic curves, there are no such groups
``by nature''. They are constructed on the
curves with the purpose to use them in cryptography.
Therefore, \acronym{ec} may sometimes feel a bit
artificial. It is important to understand that
the group we define on the curves is defined
voluntarily according to our purpose.
When we speak of \emph{point addition} in this
context, one must not confuse this operation
with the arithmetic operation of addition.
It is something totally different.

Anyway, what are elliptic curves in the first place?
Elliptic curves are polynomials that were
intensively studied in the late $19^{th}$ century,
especially by German mathematician Karl Weierstrass (1815 -- 1897),
who was of huge importance in the sound fundamentation
of analysis. We will meet him again in the third part.
He studied polynomials of the form

\begin{equation}
  y^2 = x^3 + ax + b,
\end{equation}

which is said to be in \emph{Weierstrass form}.
We can easily transform this equation
into a form that looks more like something that
can be computed, namely:

\begin{equation}
  y = \sqrt{x^3 + ax + b}.
\end{equation}

But be careful! Weierstrass polynomials are not functions,
at least not in $\mathbb{R}$, since there is not exactly
one $y$ for each $x$. When the expression $x^3 + ax + b$
becomes negative, there is, in the world of real numbers, 
no solution for the right-hand side of the equation.

This is quite obvious, when we look at the geometric
interpretation of that polynomial. It looks -- more or less --
like in the following sketch:

\begin{center}
\begin{tikzpicture}
   \draw [<->] (-3,0) -- (3,0);
   \draw [<->] (0,-3) -- (0,3);
   \draw [teal, 
scale=0.5,domain=-1.769292354238631:3,variable=\x,smooth,samples=250]
       plot ({\x}, {sqrt(\x*\x*\x - 2*\x + 2)});
   \draw [teal, 
scale=0.5,domain=-1.769292354238631:3,variable=\x,smooth,samples=250]
       plot ({\x}, {-sqrt(\x*\x*\x - 2*\x + 2)});
\end{tikzpicture}
\end{center}

The exact shape depends on the coefficients $a$ and $b$.
The bubble on the left may sometimes be a circle or ellipse
completely separated from the ``tail'' on the right;
it may, in other cases, be less clearly distinguished
from the tail on the right, forming just a tiny bulge in the tail.

In any case, the curve ``ends'' on the left-hand side
for some $x < 0$. More precisely, it ends where 
the absolute value of $x^3$, for a negative
value, becomes greater than $ax + b$. Then, the whole 
expression becomes negative and no real square root corresponds to it.

We will now start to construct a group on this kind of curves.
We call it an \emph{additional group}, but be aware that this
is not addition in the sense of the arithmetic operation.
It has nothing to do with that! It is a way to combine points
with each other that can be captured in a  -- more or less -- 
simple formula. We will start by giving a geometric interpretation
of this operation. This will help getting an intuition.
But, again, be aware that we are not dealing with geometry.
We will soon deviate from geometry and talk about curves
in a quite abstract way.

The following sketch shows an elliptic curve
with three points $P$, $Q$ and $R$,
all coloured in red.
These points are in the relation
$P + Q = R$.

% ------------------------------------------------------------------------
% Point Addition (distinct points)
% ------------------------------------------------------------------------
\begin{center}
\begin{tikzpicture}
   \draw [<->] (-4,0) -- (4,0);
   \draw [<->] (0,-4) -- (0,4);
   \draw [teal, 
          scale=0.75,domain=-1.769292354238631:3.5,variable=\x,smooth,samples=250]
       plot ({\x}, {sqrt(\x*\x*\x - 2*\x + 2)});
   \draw [teal, 
          scale=0.75,domain=-1.769292354238631:3.5,variable=\x,smooth,samples=250]
       plot ({\x}, {-sqrt(\x*\x*\x - 2*\x + 2)});
   \draw [red,fill=red] (-1.05,1.1) circle (1.5pt);
   \node [red,font=\small,anchor=south east] (p) at (-1.2,0.9) {P};
   \draw [red,fill=red] (0.32,-0.82) circle (1.5pt);
   \node [red,font=\small,anchor=north east] (q) at (0.5,-0.95) {Q};
   \draw [gray, 
          scale=0.75,domain=-3.5:3.5,variable=\x,smooth,samples=15]
         plot ({\x}, {-1.407*\x-0.5});
   \draw [black,fill=black] (2.17,-3.42) circle (1.5pt);
   \node [font=\small,anchor=south west] (q) at (2.2,-3.4) {R'};
   \draw [dotted] (2.17,-3.9) -- (2.17,3.9);
   \draw [red,fill=red] (2.17,3.42) circle (1.5pt);
   \node [red,font=\small,anchor=north west] (q) at (2.2,3.5) {R};
\end{tikzpicture}
\end{center}

When adding two points $P$ and $Q$ on an elliptic curve, 
we draw a straight line through them (the grey one).
From the nature of the elliptic curve, it is obvious
that the straight line will meet the curve once again.
At that intersection, we draw a helper point, $R'$.
The we reflect this point across the $x$-axis, \ie
we draw another line (the dotted one) that goes
straight up crossing $R'$. This line will meet the curve
again, namely at a point with the same $x$ coordinate,
but with the inverse of the $y$ coordinate $-y$.
That point is $R$, the result of $P + Q$.

You see that this operation has in fact nothing to do
with arithmetic addition. It is an arbitrary construction
to relate three points.
Nevertheless, it is carefully designed to give rise
to a group based on this operation, as we will see later.

For the moment, our main question is how can we
compute $R$ from $P$ and $Q$. We start by computing
the straight line. A straight line is defined by
a formula of the form

\begin{equation}
y = mx + c,
\end{equation}

where $m$ is the slope and $c$ the $y$-intercept.
What we need to do now is to find the third point,
$R'$, which, like $P$ and $Q$, lies on both,
the straight line and the elliptic curve.
To find such a point, we set the two formulas
equal. Since an elliptic curve is defined as

\begin{equation}  
y^2 = x^3 + ax + b, 
\end{equation}  

we can say

\begin{equation}  
(mx + c)^2 = x^3 + ax + b.
\end{equation}

By subtracting $(mx+c)^2$ from both sides, we get

\begin{equation}  
x^3 + ax + b - (mx + c)^2 = 0.
\end{equation}

Using the binomial theorem 
we can expand this to

\begin{equation}  
x^3 - m^2x^2 - 2mxc - c^2 + ax + b = 0.
\end{equation}

We already know two points, where this equation is fulfilled,
namely $x_P$ and $x_Q$. This means that these values
are roots of the above equation. We can hence use them for
factoring that equation into $(x-x_P)(x-x_Q)\Psi$,
where $\Psi$ is yet another factor. But we know even more.
We just have to look at the sketch above to see that there
are three roots and, hence, three factors. 
We, therefore, have $\Psi = x - x_{R'}$ and conclude that

\begin{equation}  
x^3 - m^2x^2 - 2mxc - c^2 + ax + b = (x-x_P)(x-x_Q)(x-x_{R'}).
\end{equation}

From here it is quite simple. 
We just apply the trick of the 
\emph{opposite sum of the roots}
and get

\begin{equation}  
m^2 = x_P + x_Q + x_{R'},
\end{equation}

which we can easily transform to 

\begin{equation}  
x_{R'} = m^2 - x_P - x_Q. 
\end{equation}

Since $R$, the point we are finally looking for,
is the reflection of $R'$ across the $x$-axis,
we have $x_{R} = x_{R'}$, \ie\ the points have
the same $x$-coordinate.

Computing $y_{R'}$ is again quite simple.
The points $P$ and $R'$ are on the same 
straight line. The $y$-values on a straight line
increase at a constant rate. So, we compute
the value $y$ should grow travelling on the segment
between $x_P$ and $x_R$, which is
$m(x_R - x_P)$ and add this to the 
already known $y$-value at point $P$:

\begin{equation}
y_{R'} = y_P + m(x_R - x_P).
\end{equation}

Now we compute $y_R$, the $y$-coordinate
of the reflections of $R'$ across the $x$-axis,
which is simply $-y$. 
Alternatively, we can compute that 
value directly by rearranging the 
equation to

\begin{equation}
y_R = m(x_P - x_R)-y_P.
\end{equation}

The final piece missing now is the slope, $m$,
which can  be expressed as a fraction:

\begin{equation}
m = \frac{y_Q - y_P}{x_Q - x_P}.
\end{equation}

With this equation, however,
we get into trouble. Everything is fine,
when we assume that we add two distinct
points $P$ and $Q$. But if we have
$P = Q$, \ie\ if we want to add a point
to itself, then the denominator of
the above fraction becomes negative.
That, clearly, is to be avoided.

To avoid that, we use, instead of a secant line
that intersects the curve, the tangent line at
point $P$, which, as we already know, measures 
the slope of the curve at $P$.
Geometrically, this corresponds to the following sketch:

% ------------------------------------------------------------------------
% Point Doubling
% ------------------------------------------------------------------------
\begin{center}
\begin{tikzpicture}
   \draw [<->] (-4,0) -- (4,0);
   \draw [<->] (0,-4) -- (0,4);
   \draw [teal, 
          scale=0.75,domain=-1.769292354238631:3.5,variable=\x,smooth,samples=250]
       plot ({\x}, {sqrt(\x*\x*\x - 2*\x + 2)});
   \draw [teal, 
          scale=0.75,domain=-1.769292354238631:3.5,variable=\x,smooth,samples=250]
       plot ({\x}, {-sqrt(\x*\x*\x - 2*\x + 2)});
   \draw [red,fill=red] (-0.9,1.25) circle (1.5pt);
   \node [red,font=\small,anchor=south east] (p) at (-1.2,0.9) {P};
   \draw [gray, 
          scale=0.75,domain=-4.5:3.5,variable=\x,smooth,samples=15]
         plot ({\x}, {0.7*\x+2.5});
   \draw [red,fill=red] (2.17,-3.42) circle (1.5pt);
   \node [red,font=\small,anchor=south west] (q) at (2.2,-3.4) {R};
   \draw [dotted] (2.17,-3.9) -- (2.17,3.9);
   \draw [black,fill=black] (2.17,3.42) circle (1.5pt);
   \node [black,font=\small,anchor=north west] (q) at (2.2,3.5) {R'};
\end{tikzpicture}
\end{center}

Here, we draw the tangent line at $P$.
Where the tangent line intersects the curve again,
we draw the helper point $R'$. We reflect it across
the $x$-axis and obtain the point $R = P+P = 2P$.

As you hopefully remember, the slope of a curve 
at a given point can be calculated with the derivative of that curve.
We will apply that derivative trick to get the tangent line
at $P$. This task, however, is a bit more difficult than
for the trivial cases we have seen so far.
Until now, we have seen derivatives of simple functions like
$f(x) = x^2$, whose derivative is $f'(x) = 2x$.
Now, we have the equation

\begin{equation}
y^2 = x^3 + ax + b.
\end{equation}

We can interpret this equation as an application of
two different functions. The first function, say, $g$,
is $g(x) = x^3 + ax + b$. The second function, $f$, is
$f(x) = \sqrt{x} = x^{\frac{1}{2}}$.

For such cases, we have the \term{chain rule},
which we will discuss more thoroughly in part 3.
The chain rule states that the derivative of
the composition of two functions is

\begin{equation}
(f \circ g)' = (f' \circ g) \times g'.
\end{equation}

That is, the derivative of the composition 
of two functions $f$ and $g$ is 
the derivative of $f$ applied on $g$ times the
derivative of $g$. Let us figure out 
what the derivatives of our $f$ and $g$ are. 
The derivative of $g$ is easy:

\[
g'(x) = 3x^2 + a
\]

A bit more difficult is $f'$. If $f(x) = x^\frac{1}{2}$,
then 

\[
f'(x) = 
\frac{1}{2}x^{\frac{1}{2}-1} = 
\frac{1}{2}x^{-\frac{1}{2}}  =
\frac{1}{2x^{\frac{1}{2}}}. 
\]

Now, we apply this to the result of $g(x)$,
which we can elegantly present as $y^2$. 
If we plug $y^2$ into the equation above,
we get 

\[
\frac{1}{2y^{2\times\frac{1}{2}}} = \frac{1}{2y}.
\]

We now multipy this by $g'$ and get 

\[
\frac{3x^2 + a}{2y}.
\]

When we use this formula for $x=x_P$,
we get the formula to compute $m$:

\begin{equation}
m = \frac{3x_P^2 + a}{2y_P}.
\end{equation}

So, we finally have an addition formula
that covers both cases, $P \neq Q$ and $P = Q$:

\begin{equation}
x_R = \begin{cases}
        m^2 - x_P - x_Q & \textrm{if $x_P \neq x_Q$}\\
        m^2 - 2x_P      & \textrm{otherwise}
      \end{cases}
\end{equation}

and

\begin{equation}
y_R = m(x_P-x_R) - y_P,
\end{equation}

where

\begin{equation}
m = \begin{cases}
      \frac{y_Q - y_P}{x_Q - x_P} & \textrm{if  $x_P \neq x_Q$}\\[10pt]
      \frac{3x_P^2 + a}{2y_P}     & \textrm{otherwise}.
    \end{cases}
\end{equation}
\section{Projective Geometry} 
\ignore{
\begingroup\par\noindent\advance\leftskip\mathindent\(
\begin{pboxed}\SaveRestoreHook
\column{B}{@{}>{\hspre}l<{\hspost}@{}}%
\column{E}{@{}>{\hspre}l<{\hspost}@{}}%
\>[B]{}\mathbf{module}\;\Conid{ECProjective}{}\<[E]%
\\
\>[B]{}\mathbf{where}{}\<[E]%
\ColumnHook
\end{pboxed}
\)\par\noindent\endgroup\resethooks
}

To complete the construction of the group 
of points on an elliptic curve, we still
have to define the identity and the inverse.
To do this we make a detour through the
beautiful art of \emph{Projective Geometry}.
To be honest, we do not need too many
concepts of Projective Geometry in practice.
But with an intuitive understanding of those concepts
the jargon common in \acronym{ec} cryptography
becomes much clearer. Besides, Projective Geometry
is really a beautiful part of mathematics
worth studying whether we need it for \acronym{ec}
or not.

Geometry is often concerned with difference and
equality of quantities like lengths and angles.
In this type of geometry, called \emph{metric geometry},
one studies properties of objects under transformations
that do not change the objectives themselves.
A typical statement is, for instance, that two triangles
are congruent (and hence equal), when one of them
was rotated or moved. The triangles below,
for instance, are all congruent to each other:

% ------------------------------------------------------------------------
% Tumbling triangle
% ------------------------------------------------------------------------
\begin{center}
\begin{tikzpicture}
\draw (0,0) -- (2,0) -- (1,1);
\draw (0,0) -- (1,1);
\draw (3,0) -- (4.414,0) -- (4.414,1.414);
\draw (3,0) -- (4.414,1.414);
\draw (5.5,1) -- (7.5,1) -- (6.5,0);
\draw (5.5,1) -- (6.5,0); 
\draw (8.5,0) -- (9.941,0) -- (8.5,1.414);
\draw (8.5,0) -- (8.5,1.414);
\end{tikzpicture}
\end{center}

In fact, we could say it is four times
the same triangle tumbling around.
We are now looking at what remains 
from metric geometry, when we do not
look at lengths and angles in the first place.
One way to do so is by looking at logic configurations
according to some basic notion, such as that of parallel lines.
This gives rise to what is called \emph{affine geometry}.
Another way is to look at transformations 
that preserve \emph{perspective} and this is indeed
what projective geometry does.

The triangles above are, as you can see, drawn on a plane.
We could now take another plane, just as we would grab a
piece of paper, and \emph{project} the points on the first
plane onto the second plane. The two planes do not need
to fulfil any specific configuration. They may be parallel
to each other or they may be arranged in different angels
according to some orientation in the surrounding space. 
The latter is an important aspect: we look at transformations
of two-dimensional figures on a two-dimensional plane.
But the transformations are created by projecting one figure
through three-dimensional space onto another plane.
Of course, we can generalise this to $n$-dimensional planes
that are arranged in an $n+1$-dimensional space.
But that would be far beyond our needs. Two-dimensional planes
and three-dimensional spaces is all we need. 

Projective transformations relate points on one plane,
let us call it $\pi$, to points on the other plane, $\pi\prime$,
by drawing a straight line that relates both points with yet
another point, which, in \emph{central projection}, is called
the centre and is identical for all points we project from
$\pi$ to $\pi\prime$. We can also choose to use 
\emph{parallel projection}, where points are projected 
by parallel lines, each one having its own projection ``centre''.
As we will later see, that is not a significant difference.
In projective geometry, it is in fact the same.

The following sketch shows a projection from $\pi$,
the lower plane, to $\pi\prime$ using central projection
with $O$ being the central point: 

% ------------------------------------------------------------------------
% Projective Plains
% ------------------------------------------------------------------------
\begin{center}
\begin{tikzpicture}
   % pi'
   \draw (0,0) -- (1,2) -- (3,2) -- (4,0) -- (0,0);
   \node [font=\small,anchor=north east] (pi2) at (0,0) {$\pi\prime$};

   % pi
   \draw (2,-1) -- (1,0);
   \draw [dotted] (1,0) -- (0.33,0.66); 
   \draw (0.33,0.66) -- (0,1);
   \draw (0,1) -- (0.66,1.33); % (2,2);
   \draw [dotted] (0.66,1.33) -- (2,2);
   \draw (2,-1) -- (3,0); 
   \draw [dotted] (3,0) -- (3.66,0.66);
   \draw (3.66,0.66) -- (4,1);
   \draw (4,1) -- (3.33,1.33);
   \draw [dotted] (3.33,1.33) -- (2,2);
   \node [font=\small,anchor=north east] (pi) at (2,-1) {$\pi$};

   % O
   \draw [red,fill=red] (2.5,4.5) circle (1.5pt);
   \node [font=\small,anchor=south west] (o) at (2.5,4.5) {O};

   % on pi
   \draw [gray,fill=gray] (1.2,0.8) circle (1.5pt);
   \node [gray, font=\small,anchor=north west] (a) at (1,0.8) {A};
   \draw [gray,fill=gray] (2.5,1.2) circle (1.5pt);
   \node [gray, font=\small,anchor=north west] (b) at (2.5,1.2) {B};
   \draw [gray,fill=gray] (2,0.6) circle (1.5pt);
   \node [gray, font=\small,anchor=north west] (c) at (2.1,0.6) {C};
   \draw [gray,dotted] (1.2,0.8) -- (2.5,1.2);
   \draw [gray,dotted] (1.2,0.8) -- (2,0.6);
   \draw [gray,dotted] (2,0.6) -- (2.5,1.2);

   % on pi'
   \draw [fill=teal,teal] (1.5,1.65) circle (1.5pt);
   \node [teal,font=\small,anchor=south east] (a2) at (1.4,1.6) {$A\prime$};
   \draw [fill=teal,teal] (2.5,1.8) circle (1.5pt);
   \node [teal,font=\small,anchor=south west] (b2) at (2.5,1.6) {$B\prime$};
   \draw [fill=teal,teal] (2.1,1.32) circle (1.5pt);
   \node [teal,font=\small,anchor=east] (c2) at (2,1.2) {$C\prime$};
   \draw [teal] (1.5,1.65) -- (2.5,1.8);
   \draw [teal] (1.5,1.65) -- (2.1,1.32);
   \draw [teal] (2.5,1.8) -- (2.1,1.32);

   % projection lines
   \draw [dotted,red]  (1.2,0.8) -- (2.5,4.5);
   \draw [dotted,red]  (2.5,1.2) -- (2.5,4.5);
   \draw [dotted,red]  (2,0.6) -- (2.5,4.5);
   
\end{tikzpicture}
\end{center}

There are, on $\pi$, three points, $A$, $B$ and $C$,
which, of course, form a triangle. The points are projected
on $\pi\prime$ along the lines relating each of the points
with $O$. We see that all points on $\pi$ appear on $\pi\prime$
and we see that one of the properties that are preserved
is that on both planes these points form a triangle pointing
roughly in the same direction. The triangle, however, are of 
different size and, due to different arrangement of the planes
in space, the shape of the original triangle is distorted on
$\pi\prime$.

Projective geometry studies properties that remain
unchanged under projection. Such properties are essential
for us recognising projected shapes. It is therefore
no surprise that projective geometry was originally
introduced to mathematics by math-literate painters,
in particular renaissance artists like Leonardo da Vinci and
Albrecht Dürer. Today it is widely used in
image processing, in digital cameras for instance.

The founding father of the mathematical discipline
of projective geometry was the French 
engineer, architect and mathematician 
Girard Desargues (1591 -- 1661). Desargues formulated
and proved \emph{Desargues' theorem}, one of the first
triumphs of projective geometry. The theorem states that,
if two triangles are situated such that the straight lines
joining corresponding vertices of the triangles intersect
in a point $O$, then the corresponding sides, when
extended, will intersect in three points that are all
on the same line. Here is a sketch to make that
a bit clearer:

% ------------------------------------------------------------------------
% Desargues' Theorem
% ------------------------------------------------------------------------
\begin{center}
\begin{tikzpicture}
   \draw (0,5) -- (1,3) -- (2,4) -- (0,5);
   \draw (3,4.37) -- (1.6,3.05) -- (3.5,3.85) -- (3,4.37);

   \draw [blue,dotted] (1.6,3.05) -- (0,1.54);
   \draw [blue,dotted] (1,3) -- (1.8,1.4); % (2,1);
   \draw [blue,dotted] (1,3) -- (0,2);
   \draw [blue,dotted] (1.6,3.05) -- (0,2.37);
   \draw [blue,dotted] (2,4) -- (6,2);
   \draw [blue,dotted] (3.5,3.85) -- (5.5,1.77);

   \draw [red,fill=red] (7,3.5) circle (1.5pt);
   \node [red,font=\small,anchor=north west] (o) at (7,3.5) {O};

   \draw [teal] (0,2.7) -- (7,2.7);
   \node [teal,font=\small,anchor=north east] (l) at (6.5,2.7) {l};

   \draw [dotted,red] (0,5) -- (7,3.5);
   \draw [dotted,red] (1,3) -- (7,3.5);
   \draw [dotted,red] (2,4) -- (7,3.5);
\end{tikzpicture}
\end{center}

The red elements capture the precondition of the theorem:
corresponding vertices of the triangles 
lie on lines that intersect
in one point $O$.
The blue lines extend the sides of the triangle and
the pairs of corresponding sides all intersect, each side
with its corresponding side, on the same line $l$.


\ignore{
- metric geometry vs. affine and projective geometry
- group of projective transformations
- Desargue's theorem 1
- Cross Ratio
- points and lines at infinity
- Cross ratio with point at infitiy
- Desargue's theorem 2
- Reflection lines are all parallel, i.e.
- they intersect at a point at infinity
- Reflections across the x-axis of points on an elliptic curve
  lie on a straight line together with that point at infinity
- If we do something like the construction, we called addition,
  with two points that are reflections of each other, we will
  not meet the curve again, but we will meet the point at infinity
- That point is the identity, such that
- P+P' = O
}

\ignore{
% ------------------------------------------------------------------------
% Point Addition (distinct points)
% ------------------------------------------------------------------------
\begin{center}
\begin{tikzpicture}
   \draw [<->] (-4,0) -- (4,0);
   \draw [<->] (0,-4) -- (0,4);
   \draw [teal, 
          scale=0.75,domain=-1.769292354238631:3.5,variable=\x,smooth,samples=250]
       plot ({\x}, {sqrt(\x*\x*\x - 2*\x + 2)});
   \draw [teal, 
          scale=0.75,domain=-1.769292354238631:3.5,variable=\x,smooth,samples=250]
       plot ({\x}, {-sqrt(\x*\x*\x - 2*\x + 2)});
   \draw [red,fill=red] (-1.05,1.1) circle (1.5pt);
   \node [red,font=\small,anchor=south east] (p) at (-1.2,0.9) {P};
   \draw [red,fill=red] (0.32,-0.82) circle (1.5pt);
   \node [red,font=\small,anchor=north east] (q) at (0.5,-0.95) {Q};
   \draw [gray, 
          scale=0.75,domain=-3.5:3.5,variable=\x,smooth,samples=15]
         plot ({\x}, {-1.407*\x-0.5});
   \draw [black,fill=black] (2.17,-3.42) circle (1.5pt);
   \node [font=\small,anchor=south west] (q) at (2.2,-3.4) {R'};
   \draw [dotted] (2.17,-3.9) -- (2.17,3.9);
   \draw [red,fill=red] (2.17,3.42) circle (1.5pt);
   \node [red,font=\small,anchor=north west] (q) at (2.2,3.5) {R};
\end{tikzpicture}
\end{center}
}
\section{EC modulo a Prime} 
\section{EC Crypto Systems} 
\section{Cryptoanalysis} 
\section{Mr. Frobenius} 
\section{Mr. Schoof} 
\section{Mr. Elkies and Mr. Aktin} 
\section{EC in Practice} 


\end{document}
